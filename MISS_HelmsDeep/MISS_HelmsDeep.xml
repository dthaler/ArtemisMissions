<mission_data version="2.7.5" background_id_arme="2e949b92-fa5c-4c26-a157-dae7b1b314d2" playerShipNames_arme="Artemis\Intrepid\Aegis\Horatio\Excalibur\Hera\Ceres\Diana">
  <mission_description>Two-bridge mission where one bridge plays a TSN station under attack, and the other bridge plays a Pirate ship.  Will they cooperate?</mission_description>
  <start id_arme="2e949b92-fa5c-4c26-a157-dae7b1b314d2">
    <!---->
    <!--Game Setup-->
    <!---->
    <log text="Start" />
    <set_difficulty_level value="5" />
    <set_skybox_index index="10" />
    <set_object_property property="nebulaIsOpaque" value="0" />
    <set_object_property property="sensorSetting" value="2" />
    <big_message title="Helms Deep" subtitle1="by Dave Thaler and Colin Chick" subtitle2="a two-bridge adventure for Artemis 2.7.5" />
    <!--Debug properties.  Set these to non-zero for debugging purposes.-->
    <set_variable name="DisableContinualEvents" value="0.0" integer="yes" />
    <!---->
    <!--Space Map Setup-->
    <!---->
    <create count="100" type="asteroids" startX="100000.0" startY="0.0" startZ="0.0" endX="0.0" endY="0.0" endZ="100000.0" />
    <create count="150" type="mines" startX="100000.0" startY="500.0" startZ="80000.0" endX="80000.0" endY="500.0" endZ="100000.0" randomRange="25" />
    <create count="150" type="mines" startX="100000.0" startY="-500.0" startZ="80000.0" endX="80000.0" endY="-500.0" endZ="100000.0" randomRange="25" />
    <create count="150" type="mines" startX="100000.0" startY="167.0" startZ="80000.0" endX="80000.0" endY="167.0" endZ="100000.0" randomRange="25" />
    <create count="150" type="mines" startX="100000.0" startY="-167.0" startZ="80000.0" endX="80000.0" endY="-167.0" endZ="100000.0" randomRange="25" />
    <!--<create type="nebulas" startX="95327.0" startY="0.0" startZ="93874.0" endX="95327.0" endY="0.0" endZ="93874.0" count="10" />-->
    <create type="monster" monsterType="8" x="80000.0" y="0.0" z="60000.0" angle="0" name="SG1" />
    <set_monster_tag_data tag_slot="0" name="SG1" />
    <set_monster_tag_data tag_slot="1" name="SG1" />
    <set_monster_tag_data tag_slot="2" name="SG1" />
    <set_monster_tag_data tag_slot="3" name="SG1" />
    <create type="monster" monsterType="8" x="20000.0" y="0.0" z="60000.0" angle="0" name="SG2" />
    <set_monster_tag_data tag_slot="0" name="SG2" />
    <set_monster_tag_data tag_slot="1" name="SG2" />
    <set_monster_tag_data tag_slot="2" name="SG2" />
    <set_monster_tag_data tag_slot="3" name="SG2" />
    <!---->
    <!--TSN Setup-->
    <!---->
    <create type="station" x="95182.0" y="0.0" z="93874.0" angle="0" name="Helms Deep" raceKeys="Terran" hullKeys="Command Base Base" />
    <clear_player_station_carried name="Helms Deep" />
    <set_player_carried_type player_slot="0" bay_slot="0" raceKeys="TSN player" hullKeys="TSN LR Shuttle" name="Red-0" />
    <set_player_carried_type player_slot="0" bay_slot="1" raceKeys="TSN player" hullKeys="TSN Bomber" name="Red-1" />
    <set_player_carried_type player_slot="0" bay_slot="2" raceKeys="TSN player" hullKeys="TSN Bomber" name="Red-1" />
    <set_player_carried_type player_slot="0" bay_slot="3" raceKeys="TSN player" hullKeys="TSN Bomber" name="Red-3" />
    <set_player_carried_type player_slot="0" bay_slot="4" raceKeys="TSN player" hullKeys="TSN Bomber" name="Red-4" />
    <set_player_carried_type player_slot="0" bay_slot="5" raceKeys="TSN player" hullKeys="TSN Bomber" name="Red-5" />
    <set_player_station_carried name="Helms Deep" raceKeys="TSN" hullKeys="TSN Bomber" singleSeatName="Red-6" />
    <set_variable name="FightersManufactured" value="6.0" integer="yes" />
    <create type="player" player_slot="0" x="95182.0" y="0.0" z="93874.0" angle="0" sideValue="2" raceKeys="TSN player" hullKeys="carrier" warp="yes" jump="no" />
    <!--AI Miner-->
    <create type="neutral" x="97652.0" y="0.0" z="97796.0" angle="0" name="MineLayer" raceKeys="TSN" hullKeys="Mine Layer" />
    <set_object_property property="topSpeed" value="6.0" name="MineLayer" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="MineLayer" />
    <set_variable name="MineLayerMines" value="25.0" integer="yes" />
    <!--Planet-->
    <create type="genericMesh" x="93148.0" y="0.0" z="95907.0" angle="0" name="Shield" meshFileName="dat\Missions\MISS_HelmsDeep\Object.dxs" textureFileName="dat/electricNoise2.png" fakeShieldsFront="1000" colorRed="1.0" colorGreen="0.0" colorBlue="1.0" />
    <set_object_property property="pushRadius" value="1000.0" name="Shield" />
    <set_object_property property="blocksShotFlag" value="1000.0" name="Shield" />
    <set_variable name="TsnScore" value="0.0" integer="yes" />
    <!---->
    <!--Pirate Setup-->
    <!---->
    <create type="player" player_slot="1" x="10000.0" y="0.0" z="20000.0" angle="0" sideValue="3" raceKeys="Pirate" hullKeys="Strongbow" warp="yes" jump="no" />
    <create type="neutral" x="16732.0" y="0.0" z="12808.0" angle="0" name="Miner" raceKeys="Pirate" hullKeys="Strongbow" sideValue="3" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Miner" />
    <set_variable name="PirateScore" value="0.0" integer="yes" />
    <!---->
    <!--Torgoth Armada Setup-->
    <!---->
    <create type="enemy" x="88790.0" y="0.0" z="86610.0" angle="200" name="T1" raceKeys="Torgoth" hullKeys="large" fleetnumber="-1" />
    <!--Enemy-->
    <create type="enemy" x="16296.0" y="0.0" z="21525.0" angle="0" raceKeys="Torgoth" hullKeys="large" fleetnumber="-1" />
  </start>
  <folder_arme name="TSN Events" id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa" expanded_arme="" />
  <event name="Player ship 0 created" id_arme="353b89a6-114f-48a6-b74d-4244cc91307b" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_exists player_slot="0" />
    <if_variable name="Ship0Initialized" comparator="EQUALS" value="0.0" />
    <log text="Player ship 0 created" />
    <set_variable name="Ship0Initialized" value="1.0" />
    <set_timer name="TsnIntroTimer" seconds="15" />
  </event>
  <event name="Force no impulse or warp" id_arme="64786996-651f-4a98-8687-d0d319bb741d" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_variable name="DisableContinualEvents" comparator="EQUALS" value="0.0" />
    <set_player_grid_damage value="1.0" player_slot="0" index="0" systemType="systemWarp" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="1" systemType="systemWarp" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="2" systemType="systemWarp" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="3" systemType="systemWarp" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="4" systemType="systemWarp" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="0" systemType="systemImpulse" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="1" systemType="systemImpulse" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="2" systemType="systemImpulse" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="3" systemType="systemImpulse" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="4" systemType="systemImpulse" countFrom="front" />
    <set_player_grid_damage value="1.0" player_slot="0" index="5" systemType="systemImpulse" countFrom="front" />
  </event>
  <event name="TSN Intro" id_arme="afbe13c5-681c-4a1a-9420-ed284814d82d" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_variable name="TsnIntroSent" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="TsnIntroTimer" />
    <log text="TSN Intro" />
    <incoming_comms_text from="TSN Command" sideValue="2" type="ALERT">The enemy armada is approaching DS1!  You will have to hold it on your own, unless you can get those pirates out there somewhere to assist.^^You have an AI MineLayer at your command with |MineLayerMines| mines.</incoming_comms_text>
    <set_timer name="RefreshCommsButtons" seconds="30" />
    <set_variable name="TsnIntroSent" value="1.0" integer="yes" />
    <set_comms_button text="Lay Mine" sideValue="2" />
    <set_variable name="DropMinesButtonPresent" value="1.0" integer="yes" />
  </event>
  <folder_arme name="AI miner" id_arme="4af61a28-62d1-43d1-b58a-f8c906389594" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa" expanded_arme="" />
  <event name="Drop mine" id_arme="a6b3acb9-8835-4a7e-af84-9293200f41cb" parent_id_arme="4af61a28-62d1-43d1-b58a-f8c906389594">
    <if_comms_button text="Lay Mine" />
    <log text="Drop mine" />
    <get_object_property property="positionX" name="Miner" variable="MinerX" />
    <get_object_property property="positionY" name="Miner" variable="MinerY" />
    <get_object_property property="positionZ" name="Miner" variable="MinerZ" />
    <get_object_property property="angle" name="Miner" variable="MinerRadians" />
    <set_variable name="MinerDegrees" value="(MinerRadians * 57.2957795)" />
    <create count="1" type="mines" startAngle="MinerDegrees" endAngle="MinerDegrees" startX="MinerX" startY="MinerY" startZ="MinerZ" radius="1000" />
    <set_variable name="MineLayerMines" value="MineLayerMines-1" integer="yes" />
    <incoming_comms_text from="Miner" type="FRIEND">We have |MineLayerMines| remaining.</incoming_comms_text>
  </event>
  <event name="Clear mines left if minelayer destroyed" id_arme="a6cdb39e-ccd3-447c-958f-c959d64b7256" parent_id_arme="4af61a28-62d1-43d1-b58a-f8c906389594">
    <if_variable name="MineLayerMines" comparator="GREATER" value="0.0" />
    <if_not_exists name="MineLayer" />
    <log text="Clear mines left if minelayer destroyed" />
    <set_variable name="MineLayerMines" value="0.0" integer="yes" />
  </event>
  <event name="Clear mine layer button when empty" id_arme="9d7fa2bb-8223-482b-8fa1-d51fef07b1eb" parent_id_arme="4af61a28-62d1-43d1-b58a-f8c906389594">
    <if_variable name="MineLayerMines" comparator="EQUALS" value="0.0" />
    <if_variable name="DropMinesButtonPresent" comparator="EQUALS" value="1.0" />
    <log text="Clear mine layer button when empty" />
    <set_variable name="DropMinesButtonPresent" value="0.0" integer="yes" />
    <clear_comms_button text="Lay Mine" sideValue="2" />
  </event>
  <event name="Refresh Comms buttons" id_arme="99b48c24-23df-442e-aa14-19b9b778514e" parent_id_arme="4af61a28-62d1-43d1-b58a-f8c906389594">
    <if_timer_finished name="RefreshCommsButtons" />
    <if_variable name="DropMinesButtonPresent" comparator="EQUALS" value="1.0" />
    <clear_comms_button text="Lay Mine" sideValue="2" />
    <set_comms_button text="Lay Mine" sideValue="2" />
    <set_timer name="RefreshCommsButtons" seconds="30" />
  </event>
  <event name="SG1 scanned" id_arme="7c977483-744d-4d4a-a3ab-bf8972e4a5b4" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_variable name="ProbeSucceeded" comparator="EQUALS" value="0.0" />
    <if_scan_level name="SG1" side="2" comparator="GREATER" value="0" />
    <log text="SG1 scanned" />
    <set_variable name="ProbeSucceeded" value="1.0" integer="yes" />
    <incoming_comms_text from="SG1" sideValue="2" type="ALERT">Probe successful</incoming_comms_text>
  </event>
  <disabled_event name="Restock bombers" id_arme="c901179e-a9a5-4fc2-8047-c926dc337215" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_not_exists name="Red-1" />
    <log text="Restock bombers" />
  </disabled_event>
  <disabled_event name="Prevent fighters from crossing diagonal" id_arme="31f89d38-0143-4298-af2d-39e9cb4d35a4" parent_id_arme="c13bd7e0-f4b1-4dd0-98ba-109f7e8ac6fa">
    <if_difficulty comparator="EQUALS" value="7" />
    <log text="Prevent fighters from crossing diagonal" />
    <!--TODO: fill this in-->
  </disabled_event>
  <folder_arme name="Pirate Events" id_arme="58c2f639-2e5d-44ea-8ab5-10cb136a0cb1" expanded_arme="" />
  <folder_arme name="Player ship initialization" id_arme="0a737b19-47ab-4ccb-a2bb-a072ad49ee0b" parent_id_arme="58c2f639-2e5d-44ea-8ab5-10cb136a0cb1" expanded_arme="" />
  <event name="Player ship 1 created" id_arme="64982b23-719e-4d78-a74c-086ce6d8365c" parent_id_arme="0a737b19-47ab-4ccb-a2bb-a072ad49ee0b">
    <if_exists player_slot="1" />
    <if_variable name="Ship1Initialized" comparator="EQUALS" value="0.0" />
    <log text="Player ship 1 created" />
    <set_variable name="Ship1Initialized" value="1.0" />
    <set_object_property property="positionX" value="10000.0" player_slot="1" />
    <set_object_property property="positionY" value="0.0" player_slot="1" />
    <set_object_property property="positionZ" value="20000.0" player_slot="1" />
    <set_object_property property="angle" value="0.0" player_slot="1" />
    <set_timer name="PirateIntroTimer" seconds="15" />
  </event>
  <event name="Pirate Intro" id_arme="6775c6d5-37a2-48d7-8e3d-7db5d3a99805" parent_id_arme="58c2f639-2e5d-44ea-8ab5-10cb136a0cb1">
    <if_variable name="PirateIntroSent" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="PirateIntroTimer" />
    <log text="Pirate Intro" />
    <incoming_comms_text from="GAME SERVER" sideValue="3" type="ALERT">Your pirate ship will be scored based on how much Latinum you can collect, whether from mining or looting or any other means.</incoming_comms_text>
    <set_variable name="PirateIntroSent" value="1.0" integer="yes" />
  </event>
  <folder_arme name="Joint Events" id_arme="f3d012a5-0f1e-4f91-b16d-d0bb1745ad7e" expanded_arme="" />
  <event name="Victory" id_arme="dcab75b6-8026-4f2a-9c42-303b41dce749" parent_id_arme="f3d012a5-0f1e-4f91-b16d-d0bb1745ad7e">
    <if_fleet_count comparator="EQUALS" value="0.0" sideValue="1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="Victory" />
    <log text="TSN score: |TsnScore|" />
    <log text="Pirate score: |PirateScore|" />
    <incoming_comms_text from="Game Server" sideValue="2" type="ALERT">TSN Score: |PirateScore|^Pirate Score: |PirateScore|</incoming_comms_text>
    <incoming_comms_text from="Game Server" sideValue="3" type="ALERT">TSN Score: |PirateScore|^Pirate Score: |PirateScore|</incoming_comms_text>
    <big_message title="MISSION COMPLETE" subtitle1="TSN Score: |TsnScore|" subtitle2="Pirate Score: |PirateScore|" />
    <set_variable name="GameOver" value="1.0" integer="yes" />
    <set_timer name="EndGameTimer" seconds="5" />
  </event>
  <event name="Helms Deep Lost" id_arme="eb3be434-5c3e-4a60-8e12-a795ca6ce334" parent_id_arme="f3d012a5-0f1e-4f91-b16d-d0bb1745ad7e">
    <if_not_exists name="Helms Deep" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="Helms Deep destroyed" />
    <log text="TSN score: |TsnScore|" />
    <log text="Pirate score: |PirateScore|" />
    <incoming_comms_text from="Game Server" sideValue="2" type="ALERT">TSN Score: |PirateScore|^Pirate Score: |PirateScore|</incoming_comms_text>
    <incoming_comms_text from="Game Server" sideValue="3" type="ALERT">TSN Score: |PirateScore|^Pirate Score: |PirateScore|</incoming_comms_text>
    <big_message title="Mission ended because Helms Deep was lost" subtitle1="TSN Score: |TsnScore|" subtitle2="Pirate Score: |PirateScore|" />
    <set_variable name="GameOver" value="1.0" integer="yes" />
    <set_timer name="EndGameTimer" seconds="5" />
  </event>
  <event name="End Game" id_arme="16f1cad4-24ad-4c3a-809b-50da4af15c28" parent_id_arme="f3d012a5-0f1e-4f91-b16d-d0bb1745ad7e">
    <if_timer_finished name="EndGameTimer" />
    <log text="End Game" />
    <end_mission />
  </event>
</mission_data>