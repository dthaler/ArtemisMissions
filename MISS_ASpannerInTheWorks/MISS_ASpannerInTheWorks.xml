<mission_data version="2.6" background_id_arme="84327810-6e7d-41e7-9e71-391649f5b452" playerShipNames_arme="Artemis\Intrepid\Aegis\Horatio\Excalibur\Hera\Ceres\Diana">
  <start id_arme="84327810-6e7d-41e7-9e71-391649f5b452">
    <create count="200" type="asteroids" startX="90000.0" startY="0.0" startZ="38699.0" endX="10000.0" endY="0.0" endZ="28699.0" randomRange="20000" randomSeed="100" />
    <create count="200" type="asteroids" startX="90000.0" startY="200.0" startZ="38699.0" endX="10000.0" endY="200.0" endZ="28699.0" randomRange="20000" randomSeed="200" />
    <create count="200" type="asteroids" startX="90000.0" startY="-200.0" startZ="38699.0" endX="10000.0" endY="-200.0" endZ="28699.0" randomRange="20000" randomSeed="300" />
    <create count="200" type="asteroids" startX="90000.0" startY="-400.0" startZ="38699.0" endX="10000.0" endY="-400.0" endZ="28699.0" randomRange="20000" randomSeed="400" />
    <create count="200" type="asteroids" startX="90000.0" startY="400.0" startZ="38699.0" endX="10000.0" endY="400.0" endZ="28699.0" randomRange="20000" randomSeed="500" />
    <create type="player" x="48206.0" y="0.0" z="87373.0" angle="0" name="Artemis" />
    <set_variable name="StationX" value="27764.0" />
    <set_variable name="StationY" value="0.0" />
    <set_variable name="StationZ" value="73016.0" />
    <create type="station" x="StationX" y="StationY" z="StationZ" angle="0" name="DS1" raceKeys="friendly" hullKeys="Deep Space Base base" />
    <create type="neutral" x="StationX - 10" y="StationY + 50.0" z="StationZ" angle="0" name="Diana" hullID="0" sideValue="2" />
    <create type="neutral" x="4093.0" y="0.0" z="46077.0" angle="320" name="S01" raceKeys="Terran friendly" hullKeys="science" sideValue="2" />
    <clear_ai name="S01" />
    <add_ai type="PROCEED_TO_EXIT" name="S01" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="S01" />
    <create type="neutral" x="91841.0" y="0.0" z="96053.0" angle="45" name="S02" raceKeys="Terran friendly" hullKeys="cargo" sideValue="2" />
    <clear_ai name="S02" />
    <add_ai type="PROCEED_TO_EXIT" name="S02" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="S02" />
    <create type="neutral" x="98378.0" y="0.0" z="64527.0" angle="75" name="S03" raceKeys="Terran friendly" hullKeys="luxury" sideValue="2" />
    <clear_ai name="S03" />
    <add_ai type="PROCEED_TO_EXIT" name="S03" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="S03" />
    <create type="neutral" x="4964.0" y="0.0" z="96198.0" angle="0" name="S04" raceKeys="Terran friendly" hullKeys="transport" sideValue="2" />
    <clear_ai name="S04" />
    <add_ai type="PROCEED_TO_EXIT" name="S04" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="S04" />
    <create type="neutral" x="14553.0" y="0.0" z="10484.0" angle="200" name="S05" raceKeys="Terran friendly" hullKeys="small" sideValue="2" />
    <clear_ai name="S05" />
    <add_ai type="PROCEED_TO_EXIT" name="S05" />
    <add_ai type="CHASE_AI_SHIP" name="S05" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="S05" />
    <add_ai type="DEFEND" value2="1000" value1="3000" name="S05" />
    <add_ai type="CHASE_ANGER" name="S05" />
    <set_skybox_index index="10" />
    <set_object_property property="musicObjectMasterVolume" value="0.0" />
    <set_variable name="DockedRange" value="100.0" />
    <set_variable name="SabotageDelaySeconds" value="300.0" />
    <big_message title="A Spanner in the Works" subtitle1="A Diana Series Mission by Dave Thaler" subtitle2="An adventure for one or two ships for Artemis 2.6" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <set_variable name="TractorStrength" value="2.0" />
    <!--Initialize any variables that must be integers:-->
    <set_variable name="HackSuccessesNeeded" value="5.0" integer="yes" />
    <set_variable name="DamConTeamSent" value="0.0" integer="yes" />
    <set_variable name="HackStepsSucceeded" value="0.0" integer="yes" />
    <set_variable name="BombsSet" value="0.0" integer="yes" />
    <set_variable name="MaxBombs" value="1.0" integer="yes" />
    <set_variable name="PlayerShipCount" value="0.0" integer="yes" />
    <set_variable name="SkaaranCount" value="0.0" integer="yes" />
  </start>
  <folder_arme name="Initialization" id_arme="6ef97816-b707-4333-8e81-c10c250bf89b" />
  <event name="Disable Diana impulse and turning" id_arme="519bff8f-c77c-4692-b182-acda4ba82a5b" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="0.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <clear_ai name="Diana" />
    <!--Face north-->
    <set_object_property property="angle" value="3.14" name="Diana" />
    <set_ship_text name="Diana" scan_desc="The Diana is unmanned, and is undergoing reconstruction." />
  </event>
  <event name="Raise frequency A" id_arme="56e373d7-757d-4ee8-80f0-1a1fdfd92470" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength0" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency B" id_arme="a536a299-19b2-4f8a-a284-eea0f0e4b4be" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength1" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency C" id_arme="e8a54454-0838-4444-9361-9de10c992a38" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength2" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency D" id_arme="ddc2a914-96b9-4977-9510-10e1c80f72f8" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength3" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency E" id_arme="c2be3237-397a-47a4-914f-1bbde409b157" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength4" value="TempRandom" name="Diana" />
  </event>
  <event name="Lower frequency A" id_arme="50be9f21-8f6d-405f-8e8c-e98a3756517f" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength0" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency B" id_arme="5749b266-8f7c-40a2-88a4-1f11d35295ef" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength1" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency C" id_arme="e04c0fb3-2579-4955-9e63-7c0f9ba45140" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength2" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency D" id_arme="c9bc2b97-e951-4d12-89cb-67e1cef2e04c" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength3" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency E" id_arme="6cdf3470-cbbb-438e-8243-ad94c96f8cc1" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength4" value="0.5" name="Diana" />
  </event>
  <event name="Create Skaaran" id_arme="454afe64-1060-451d-8b4f-94d9363b2ed2" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_difficulty comparator="GREATER" value="SkaaranCount + 1" />
    <set_variable name="SkaaranX" randomFloatLow="10000.0" randomFloatHigh="90000.0" />
    <set_variable name="SkaaranZ" randomIntLow="10000" randomIntHigh="40000" />
    <create type="enemy" x="SkaaranX" y="0.0" z="SkaaranZ" angle="0" raceKeys="Skaraan enemy hasspecials" hullKeys="small" />
    <set_variable name="SkaaranCount" value="SkaaranCount + 1" />
  </event>
  <event name="2 MaxBombs" id_arme="a457ad0c-fda4-4b35-a5ce-2f1b47b821ab" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_variable name="MaxBombs" comparator="LESS" value="2.0" />
    <if_difficulty comparator="GREATER" value="5.0" />
    <set_variable name="MaxBombs" value="2.0" integer="yes" />
  </event>
  <folder_arme name="Start/End Game Events" id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1" />
  <event name="All Player Ships Destroyed" id_arme="42f2865c-0518-4e1b-bfc1-7556bdc0cd1b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="Aegis" />
    <if_not_exists name="Artemis" />
    <if_not_exists name="Intrepid" />
    <if_not_exists name="Horatio" />
    <if_not_exists name="Excalibur" />
    <if_not_exists name="Hera" />
    <if_not_exists name="Ceres" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <log text="FAILED because all player ships destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="All player ships have been destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^All player ships have been destroyed</incoming_comms_text>
  </event>
  <event name="End Game" id_arme="2f1aab6d-e5c1-489e-8dcd-e39c4660c27f" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="GameOver" comparator="EQUALS" value="1" />
    <if_timer_finished name="GameFinishedTimer" />
    <log text="End Game" />
    <end_mission />
  </event>
  <event name="All enemies destroyed" id_arme="8cd2c901-c296-44f2-9e21-34a669cf027b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="AB1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_variable name="TsnCommandGaveMission" comparator="GREATER" value="1.0" />
    <if_fleet_count comparator="EQUALS" value="0.0" sideValue="1" />
    <log text="MISSION SUCCEEDED" />
    <incoming_comms_text from="TSN Command" type="SIDE">Good work!  The Arvonians have abandoned their attack on DS1, at least for now.  The TSN Diana is also safe and we can now complete the renovations on her to prepare to return her to service again.</incoming_comms_text>
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION SUCCEEDED" subtitle1="All enemies have been destroyed" subtitle2="" />
  </event>
  <event name="Lost DS1" id_arme="b526982b-a60f-4850-8902-f0c9525953a5" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="DS1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0" />
    <log text="FAILED because all player bases destroyed" />
    <big_message title="MISSION FAILED" subtitle1="All player bases have been destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^All player bases have been destroyed</incoming_comms_text>
    <set_variable name="GameOver" value="1" />
    <set_timer name="GameFinishedTimer" seconds="15" />
  </event>
  <event name="Lost Diana" id_arme="df728465-db6c-46d4-bf37-05eebdf4c22d" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="Diana" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the Diana was destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The TSN Diana was destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^The TSN Diana has been destroyed</incoming_comms_text>
  </event>
  <event name="Diana Escaped" id_arme="94bc79ae-5517-4033-afa4-2bfcf435e031" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_inside_sphere name="Diana" centerX="68960.0" centerY="0.0" centerZ="0.0" radius="2500" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the saboteur escaped" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The saboteur escaped with the TSN Diana" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^The saboteur escaped with the TSN Diana</incoming_comms_text>
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="b2cb0990-403d-4203-9f02-a732053e1d82" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="LESS" value="EnemiesLeft" sideValue="1" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft - 1" />
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="3753f14f-cac2-432c-873b-68f005547932" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="GREATER" value="EnemiesLeft" sideValue="1" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft + 1" />
  </event>
  <folder_arme name="Player Ship initialization" id_arme="21712616-42f1-44fc-a39e-b0521eb9312f" />
  <event name="Create Player Ship - Artemis" id_arme="77054e94-9150-490c-b841-a94b75764284" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Artemis" />
    <if_variable name="ArtemisInitialized" comparator="EQUALS" value="0" />
    <log text="Artemis spawned" />
    <set_object_property property="positionX" value="48206.0" name="Artemis" />
    <set_object_property property="positionZ" value="87373.0" name="Artemis" />
    <set_object_property property="positionY" value="0" name="Artemis" />
    <set_object_property property="angle" value="0.0" name="Artemis" />
    <set_variable name="ArtemisInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
  </event>
  <event name="Create Player Ship - Intrepid" id_arme="37715cd5-a873-452b-9b03-0409dab65292" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Intrepid" />
    <if_variable name="IntrepidInitialized" comparator="EQUALS" value="0" />
    <log text="Intrepid spawned" />
    <set_object_property property="positionX" value="20450" name="Intrepid" />
    <set_object_property property="positionZ" value="79400" name="Intrepid" />
    <set_object_property property="positionY" value="0" name="Intrepid" />
    <set_object_property property="angle" value="0.0" name="Intrepid" />
    <set_variable name="IntrepidInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
  </event>
  <event name="Create Player Ship - Aegis" id_arme="6e63775f-221a-4740-beb5-76207cb60034" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Aegis" />
    <if_variable name="AegisInitialized" comparator="EQUALS" value="0" />
    <log text="Aegis spawned" />
    <set_object_property property="positionX" value="20503" name="Aegis" />
    <set_object_property property="positionZ" value="79253" name="Aegis" />
    <set_object_property property="positionY" value="0" name="Aegis" />
    <set_object_property property="angle" value="0.0" name="Aegis" />
    <set_variable name="AegisInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
  </event>
  <folder_arme name="Task: Dock with DS1 to receive orders" id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6" />
  <event name="Prepare to summon ships" id_arme="b5f53049-5cf3-43b7-b98d-6a92f25d26f1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="0.0" />
    <log text="Delaying before summoning ships" />
    <set_variable name="TsnCommandSummonedShips" value="1.0" />
    <set_timer name="RefreshGMButtons" seconds="1" />
    <set_timer name="StartupDelayBeforeOrders" seconds="10" />
  </event>
  <event name="TSN Command summons ships" id_arme="db11b82c-2c75-4dfb-b2e1-fef7eb5c91b4" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">All TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders.</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="2.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="300" />
    <set_timer name="StartupDelayBeforeOrders" seconds="120" />
  </event>
  <event name="TSN Command summons ships again" id_arme="7c3e3147-e599-4707-afd7-a957d9ce8684" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
  </event>
  <event name="GM summons ships again" id_arme="92f4ecc2-d839-4ba1-b5f4-8d35ddfeeac1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="300" />
  </event>
  <event name="Mission Failed - Out of time" id_arme="875dc7e9-9018-49d1-8750-bd76aa7f387d" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0" />
    <if_timer_finished name="ShipsDueAtCommandBase" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="Did not receive missions orders in time" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="You did not follow orders from TSN Command in time" subtitle2="" />
    <incoming_comms_text from="TSN Command" type="SIDE">You did not follow orders from TSN Command in time!</incoming_comms_text>
  </event>
  <event name="Task Succeeded - 1 Ship Docked" id_arme="179e7ae6-25f8-46c5-8916-6995e3c73883" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="1.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Task Succeeded - 2 Ships Docked" id_arme="3c75cb0b-7be9-4c70-b4da-c32d8d05e60c" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="2.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Task Succeeded - 3 Ships Docked" id_arme="bee1aff2-7bd6-4346-a020-863841bbeb14" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER_EQUAL" value="3.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Aegis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="GM give mission" id_arme="c8c38a14-899f-4b30-9010-52298c0fde64" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/Give Mission" />
    <log text="GM gave mission" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Give mission" id_arme="e67adc38-f742-404e-9352-b1e0797d6519" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="1.0" />
    <log text="Gave mission" />
    <incoming_comms_text from="TSN Command" type="SIDE">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an assault on DS1.  We are sending their position to your ship now.  Your mission is to protect both DS1 and the Diana from the Arvonian invasion.  It is imperative that we not lose either one.</incoming_comms_text>
    <set_variable name="TsnCommandGaveMission" value="2.0" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <create type="enemy" x="60066.0" y="0.0" z="14499.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="1" />
    <create type="enemy" x="34630.0" y="0.0" z="33068.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="2" />
    <create type="enemy" x="78791.0" y="0.0" z="34473.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="3" />
    <create type="station" x="68960.0" y="0.0" z="20741.0" angle="0" name="AB1" raceKeys="enemy whalelover" hullKeys="base" sideValue="1" />
  </event>
  <event name="Refresh GM buttons" id_arme="f1383e6f-ee03-4dce-872f-9f43586e0033" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_exists name="DS1" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <set_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <set_gm_button text="GM/Resend Comms/Give Mission" />
    <set_timer name="RefreshGMButtons" seconds="10" />
  </event>
  <folder_arme name="Sabotage" id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd" />
  <event name="Bomb Set" id_arme="9c900198-e63b-4408-9a57-32ae99e1e2ae" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="BombsDefused" />
    <if_variable name="BombsSet" comparator="LESS" value="MaxBombs" />
    <if_timer_finished name="SabotageDelay" />
    <if_variable name="ReadyToHack" comparator="EQUALS" value="0.0" />
    <log text="Bomb set!" />
    <warning_popup_message message="Urgent message from DS1" consoles="M" />
    <incoming_comms_text from="DS1" type="STATION">URGENT: Immediate assistance needed at DS1!  We must have a sabotaur at work.  We just discovered a bomb on our station in the production facility!  We need you to dock with us as soon as possible and send a team of explosives experts who can deal with it before it detonates and destroys this station!  We have deactivated our final step in building more missiles so no more will be produced until the bomb is deactivated.</incoming_comms_text>
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="0" name="DS1" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <set_variable name="BombsSet" value="BombsSet + 1" integer="yes" />
    <set_variable name="WelcomedArtemisAwayTeam" value="0.0" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="0.0" />
    <set_variable name="WelcomedAegisAwayTeam" value="0.0" />
    <set_timer name="RefreshGMBombButtons" seconds="3" />
  </event>
  <event name="Artemis docked" id_arme="8aaa2492-326c-413c-a6ff-b38102c6a092" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedArtemisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Artemis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedArtemisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Artemis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Intrepid docked" id_arme="4e9c9d7f-1cb0-49b7-bb0d-5b8aedd79088" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedIntrepidAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Intrepid docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Intrepid. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Aegis docked" id_arme="4138f4e7-048b-429a-8666-a49be7fe3fbf" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Aegis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedAegisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Aegis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedAegisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Aegis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Refresh GM buttons" id_arme="b3049e32-14ce-4187-8b89-3322cce1a2f6" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_variable name="BombsSet" comparator="GREATER" value="BombsDefused" />
    <if_timer_finished name="RefreshGMBombButtons" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_timer name="RefreshGMBombButtons" seconds="3" />
  </event>
  <event name="Bomb Defused" id_arme="552e39ad-0ac1-4fb8-abe1-490bed21d397" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb defused" />
    <log text="Bomb defused" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="1" name="DS1" />
    <set_variable name="BombsDefused" value="BombsDefused + 1" />
    <incoming_comms_text from="DS1" type="STATION">Congratulations, the bomb has been defused and our production facility has resumed operation!</incoming_comms_text>
    <!---->
    <!--Schedule another sabotage attempt-->
    <!---->
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
  </event>
  <event name="Bomb Detonated" id_arme="486a7bdd-b0de-4d0e-ac93-723e5902f137" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb detonated" />
    <log text="Bomb detonated!" />
    <clear_gm_button text="Bomb detonated" />
    <clear_gm_button text="Bomb defused" />
    <destroy name="DS1" />
    <warning_popup_message message="DS1 has been destroyed!" consoles="M" />
  </event>
  <folder_arme name="Escape" id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55" />
  <event name="Ready to escape" id_arme="3d4352b3-37f1-405a-b323-55357faac490" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_variable name="DianaReadyToEscape" comparator="EQUALS" value="0.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="MaxBombs" />
    <log text="Saboteur about to escape" />
    <set_timer name="DianaEscapeTimer" seconds="30" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
  </event>
  <event name="Diana AI activates" id_arme="5ab5a2dd-561e-4ac8-b49a-0b96d416144e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_not_exists name="Saboteur" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="DianaEscapeTimer" />
    <if_variable name="HackStepsSucceeded" comparator="LESS" value="HackSuccessesNeeded" />
    <log text="Diana AI activates" />
    <!--Create a new ship that will become the Diana-->
    <!--We use a new ship instead of changing the side on the existing one, in order to reset the scanned level to 1.-->
    <create type="neutral" x="27754.0" y="50.0" z="73016.0" angle="0" name="Saboteur" hullID="0" sideValue="1" />
    <incoming_comms_text from="DS1" type="ALERT">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</incoming_comms_text>
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_timer name="RefreshCommsButtons" seconds="30" />
  </event>
  <event name="Saboteur Diana created" id_arme="4348db9f-e7e7-4f47-a6bf-97663c7b37e7" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_exists name="Saboteur" />
    <log text="Saboteur Diana created" />
    <set_relative_position name2="Saboteur" distance="0" angle="0" name1="Diana" />
    <clear_ai name="Saboteur" />
    <set_object_property property="exitPointZ" value="0.0" name="Saboteur" />
    <set_object_property property="exitPointX" value="68960.0" name="Saboteur" />
    <destroy name="Diana" />
    <set_ship_text name="Saboteur" newname="Diana" scan_desc="Scans indicate no life signs aboard.  The saboteur must be an AI!" />
    <set_object_property property="surrenderChance" value="0" name="Diana" />
    <add_ai type="PROCEED_TO_EXIT" name="Diana" />
  </event>
  <event name="DEBUG: Allow teleporting Diana" id_arme="8886e953-9017-4f5b-a389-50554e8d1d0d" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="TeleportDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="TeleportDianaButton" value="1.0" />
    <set_gm_button text="GM/Teleport Diana" />
  </event>
  <event name="DEBUG: Teleport Diana" id_arme="118da934-bff8-448f-a242-8cef087a2007" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_gm_button text="GM/Teleport Diana" />
    <log text="GM pressed Teleport Diana" />
    <set_object_property property="positionX" value="68940.0" name="Diana" />
    <set_object_property property="positionY" value="0.0" name="Diana" />
    <set_object_property property="positionZ" value="500.0" name="Diana" />
  </event>
  <event name="DEBUG: Allow activating saboteur" id_arme="8989b6b2-c483-4886-86e8-aa5f7e993d60" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="ActivateDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="ActivateDianaButton" value="1.0" />
    <set_gm_button text="GM/Activate saboteur" />
  </event>
  <event name="DEBUG: Activate saboteur" id_arme="b35f06a9-3a65-4d3c-85de-9155572d4d5e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_gm_button text="GM/Activate saboteur" />
    <log text="GM pressed Activate saboteur" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
    <clear_gm_button text="GM/Activate saboteur" />
    <set_timer name="DianaEscapeTimer" seconds="1" />
  </event>
  <folder_arme name="Hacking" id_arme="a587676a-7998-4d34-80cd-cee990ddefc1" />
  <event name="Ready to hack" id_arme="4d8b42f5-75fa-4443-8643-59c610e9868c" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <!--One-time event to start hacking capability-->
    <if_variable name="ReadyToHack" comparator="EQUALS" value="0.0" />
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="RefreshCommsButtons" />
    <log text="Ready to hack" />
    <set_variable name="ReadyToHack" value="1.0" />
    <set_timer name="RefreshCommsButtons" seconds="10" />
    <incoming_comms_text from="Internal Comms" type="SIDE">We can try to disrupt the Diana's computer system to stop the saboteur, but we'll have to get through multiple layers of defenses.  We'll need to use its lowest shield frequency to do so.</incoming_comms_text>
  </event>
  <event name="Refresh hack buttons" id_arme="342cc4d2-3696-4a8f-b0dc-7159300c4cfe" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="ReadyToHack" comparator="EQUALS" value="1.0" />
    <if_exists name="Diana" />
    <if_timer_finished name="RefreshCommsButtons" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="HackStepsSucceeded" comparator="LESS" value="HackSuccessesNeeded" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <set_comms_button text="Hack frequency A" />
    <set_comms_button text="Hack frequency B" />
    <set_comms_button text="Hack frequency C" />
    <set_comms_button text="Hack frequency D" />
    <set_comms_button text="Hack frequency E" />
    <set_timer name="RefreshCommsButtons" seconds="10" />
  </event>
  <event name="Hack A success" id_arme="00e10622-08be-4b6e-aed9-6bc590e765ca" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack B  success" id_arme="0f9188f4-c88c-4deb-90f3-0cdf254dccf1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack C success" id_arme="fc7bb871-93e5-4eb6-aea2-16d4ed2412e6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack D success" id_arme="743278cd-bf39-4a69-8114-0939b0ef4550" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack E success" id_arme="e26e1c0d-117c-401e-8326-359c8d81b36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack A fail" id_arme="42e749e3-8e4d-46d1-b52a-76ce65c15f02" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack B fail" id_arme="689261c5-02d4-4eaa-9147-c585e1d9d659" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack C fail" id_arme="0c590657-25e7-4c88-a0ed-22c734dcc005" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack D fail" id_arme="83a5ed74-685a-4943-a79c-c3b273da0d58" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack E fail" id_arme="b43d584e-f7c4-4ce2-876e-87b76ae6aab6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack step failed" id_arme="21c46882-1a4b-4ba4-9006-875cf570a590" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="2.0" />
    <log text="Hack step failed" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="0.0" integer="yes" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Inorrect, all computer defenses have been reset.</incoming_comms_text>
  </event>
  <event name="Hack step succeeded" id_arme="cfa626be-a329-4fcf-bbbd-e18591ecf4a1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="1.0" />
    <log text="Hack step succeeded, now up to |HackStepsSucceeded|" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" integer="yes" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Correct, we have now gotten through |HackStepsSucceeded| levels of the saboteur's^computer defenses!</incoming_comms_text>
  </event>
  <event name="BS1: Hack complete" id_arme="97d7d08e-7507-4173-bacf-f69a8c4683a4" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackStepsSucceeded" comparator="EQUALS" value="HackSuccessesNeeded" />
    <log text="Hack complete" />
    <warning_popup_message message="The Diana's engines have been disrupted" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" integer="yes" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Disruption complete, the Diana's engines are now disabled!  If we get within 500m of the Diana and send over a full 6-person DamCon team to board her, we might be able to return her to TSN control.</incoming_comms_text>
    <set_variable name="BoardingState" value="1.0" />
    <set_timer name="RefreshCommsButtons" seconds="3" />
  </event>
  <event name="Saboteur disabled" id_arme="6e9e6abc-05db-4971-8ab0-3b29b5eba36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <if_variable name="HackStepsSucceeded" comparator="GREATER_EQUAL" value="HackSuccessesNeeded" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <set_object_property property="systemDamageBeam" value="100.0" name="Diana" />
  </event>
  <folder_arme name="Boarding" id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284" />
  <event name="Refresh damcon buttons" id_arme="fb1e0719-7ca8-4e53-b66f-de3e4630f30c" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="RefreshCommsButtons" />
    <set_variable name="ArtemisDamCon1ButtonRefreshed" value="0.0" />
    <set_variable name="ArtemisDamCon2ButtonRefreshed" value="0.0" />
    <set_variable name="ArtemisDamCon3ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon1ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon2ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon3ButtonRefreshed" value="0.0" />
    <set_timer name="RefreshCommsButtons" seconds="3" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="Show Artemis DamCon 1 button" id_arme="fab1a80d-d1a4-44e3-ae63-b9901b4b9476" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 1" sideValue="3" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="2.0" />
  </event>
  <event name="Show Artemis DamCon 2 button" id_arme="85dcea4d-036d-41de-96fc-cd8760d5b993" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 2" sideValue="3" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="2.0" />
  </event>
  <event name="Show Artemis DamCon 3 button" id_arme="1c8b2fff-66da-4f8a-ae2b-aef8dc96ec69" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 3" sideValue="3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 1 button" id_arme="d83bb6c0-79a6-4707-8eb1-4671fab32e63" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 1 " sideValue="4" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 2 button" id_arme="4e5f6e78-21f7-49d9-b20a-9e523effd27b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 2 " sideValue="4" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 3 button" id_arme="15bd250a-1ce5-498f-8f64-0854bea72266" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_comms_button text="Send DamCon team 3 " sideValue="4" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="2.0" />
  </event>
  <event name="Restore Artemis side" id_arme="16646f32-7c88-4545-9446-7bf9a1b80db9" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_object_property property="sideValue" name="Artemis" comparator="NOT" value="2.0" />
    <set_side_value value="2" name="Artemis" />
  </event>
  <event name="Restore Intrepid side" id_arme="3d5ed666-7872-4786-8307-6392563004aa" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_object_property property="sideValue" name="Intrepid" comparator="NOT" value="2.0" />
    <set_side_value value="2" name="Intrepid" />
  </event>
  <event name="Allow Artemis DamCon 1" id_arme="e09e7be1-c24c-4d3a-bee1-3e76a2e387e5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon1ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Artemis DamCon 2" id_arme="22c31aa7-4be1-4e28-80f8-e3aee8ecd390" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon2ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Artemis DamCon 3" id_arme="aa7bdc06-be65-4208-9680-9aab5f98bda3" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon3ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 1" id_arme="d9eb046c-a441-41ef-ad9a-8724b03fb60c" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon1ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 2" id_arme="04aded95-cad1-4a50-8b20-a47aaee17863" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon2ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 3" id_arme="8af32ac7-66fd-4716-a827-57eb9c75be64" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="500.0" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon3ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="1.0" />
  </event>
  <event name="Disallow Artemis DamCon 1 for distance" id_arme="861df967-a1cb-4134-b39c-dc42209ec9fc" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 1" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 2 for distance" id_arme="c7b1aab1-8345-4f08-a114-d154a8d3940d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 2" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 3 for distance" id_arme="ef8d13b6-356f-49fc-a142-bfad343b88e2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 1 for size" id_arme="42434d6e-e1dd-4db1-af62-62e9c6c240c2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="0" team_index="0" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 1" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 2 for size" id_arme="7eca72a3-252e-418f-a1b2-d32472fea254" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="0" team_index="1" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 2" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 3 for size" id_arme="f3ce1617-350d-4e02-aeb1-468d7bbce7c0" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="0" team_index="2" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 1 for distance" id_arme="d01155d6-4dda-4063-a811-7736f8ab996d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 1 " />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 2 for distance" id_arme="e251fa00-8368-4caf-85bc-ab38bd10e8c5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 2 " />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 3 for distance" id_arme="e0f69dc2-597e-43f4-af9b-f077b93b2cee" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="500.0" />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 1 for size" id_arme="2a69f573-dc68-4383-81f2-89561eb15492" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="1" team_index="0" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 1 " />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 2 for size" id_arme="49cb8b5f-974e-47db-bafd-20e5d7b47aa5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="1" team_index="1" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 2 " />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 3 for size" id_arme="b5d27490-af7a-4838-8df1-a6f5022bdc75" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_damcon_members player_slot="1" team_index="2" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="BS2: Assign Artemis DamCon 1" id_arme="31e5e72c-47d8-4e36-a15f-b155a9e79358" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 1" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="1.0" />
    <set_damcon_members value="0.0" team_index="0" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Artemis DamCon 2" id_arme="dd094294-9146-4872-93fb-b6a59b529821" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 2" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="2.0" />
    <set_damcon_members value="0.0" team_index="1" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Artemis DamCon 3" id_arme="e5fb7695-b388-4fd2-91bb-56b2b8baea61" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 3" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="3.0" />
    <set_damcon_members value="0.0" team_index="2" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 1" id_arme="679fd3f6-c5ea-4ea1-b13b-aae2ed367cb1" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 1 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="1.0" />
    <set_damcon_members value="0.0" team_index="0" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 2" id_arme="dd74731f-6928-4da8-913f-f0fb0ea09bc5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 2 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="2.0" />
    <set_damcon_members value="0.0" team_index="1" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 3" id_arme="5d8ff5fb-8a22-4f1d-bd36-078caa90a34f" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 3 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="3.0" />
    <set_damcon_members value="0.0" team_index="2" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS3: Artemis DamCon Transferred" id_arme="5ee8ee64-b366-470b-9f96-6a34cff84ec8" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="1.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="2.0" />
    <log text="Diana boarded by Artemis DamCon team |DamConTeamSent|" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_timer name="ReclaimDianaTimer" seconds="30" />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Artemis DamCon team |DamConTeamSent| reporting in.  We are now on board the TSN Diana.  The AI seems to be Arvonian!  We're working on regaining manual control...</incoming_comms_text>
    <set_variable name="BoardingState" value="3.0" />
    <!--If there were a way to remove the shuttlecraft from bay 0, we would do that here too, but there appears to be no way to do that.-->
  </event>
  <event name="BS3: Intrepid DamCon Transferred" id_arme="3449a8db-e774-40f0-be0a-92857e85e35b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="2.0" />
    <log text="Diana boarded by Intrepid DamCon team |DamConTeamSent|" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_timer name="ReclaimDianaTimer" seconds="30" />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Intrepid DamCon team |DamConTeamSent| reporting in.  We are now on board the TSN Diana.  The AI seems to be Arvonian!  We're working on regaining manual control...</incoming_comms_text>
    <set_variable name="BoardingState" value="3.0" />
    <!--If there were a way to remove the shuttlecraft from bay 0, we would do that here too, but there appears to be no way to do that.-->
  </event>
  <event name="BS4: Artemis DamCon complete" id_arme="1e52fc4a-ff69-4b84-a57e-e2aa886f51d3" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="1.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="3.0" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="ReclaimDianaTimer" />
    <log text="Diana reclaimed by Artemis DamCon team |DamConTeamSent|" />
    <set_object_property property="sideValue" value="2.0" name="Diana" />
    <clear_ai name="Diana" />
    <add_ai type="POINT_THROTTLE" value1="StationX" value2="0.0" value3="StationZ" value4="1.0" name="Diana" />
    <set_ship_text name="Diana" scan_desc="Artemis DamCon team |DamConTeamSent| is on board taking her back to DS1." hailtext="We are taking the Diana back to DS1." />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Artemis DamCon team |DamConTeamSent| reporting in... From what we can tell, the AI must have been on the Diana for ages but only recently reawakened during repairs.  We have now regained control of the Diana and have set a course back to DS1!</incoming_comms_text>
    <incoming_comms_text from="DS1" type="STATION">Artemis, great work recapturing the Diana!  We'll take it from here, and interrogate the AI once the ship is safely back and locked down.</incoming_comms_text>
    <set_variable name="BoardingState" value="4.0" />
  </event>
  <event name="BS4: Intrepid DamCon complete" id_arme="7b453dce-f524-41cb-94f7-c9a5fb54d680" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="3.0" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="ReclaimDianaTimer" />
    <log text="Diana reclaimed by Intrepid DamCon team |DamConTeamSent|" />
    <set_object_property property="sideValue" value="2.0" name="Diana" />
    <clear_ai name="Diana" />
    <add_ai type="POINT_THROTTLE" value1="StationX" value2="0.0" value3="StationZ" value4="1.0" name="Diana" />
    <set_ship_text name="Diana" scan_desc="Intrepid DamCon team |DamConTeamSent| is on board taking her back to DS1." hailtext="We are taking the Diana back to DS1." />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Intrepid DamCon team |DamConTeamSent| reporting in... From what we can tell, the AI must have been on the Diana for ages but only recently reawakened during repairs.  We have now regained control of the Diana and have set a course back to DS1!</incoming_comms_text>
    <incoming_comms_text from="DS1" type="STATION">Interpid, great work recapturing the Diana!  We'll take it from here, and interrogate the AI once the ship is safely back and locked down.</incoming_comms_text>
    <set_variable name="BoardingState" value="4.0" />
  </event>
  <event name="DS1 Tractoring Diana +X" id_arme="665b8c6f-2ba0-4f01-8d40-9739ec0ad02d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Diana" comparator="LESS" value="StationX" />
    <addto_object_property value="TractorStrength" property="positionX" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -X" id_arme="7643146c-0896-4c1b-877c-9b560afac029" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Diana" comparator="GREATER" value="StationX" />
    <addto_object_property value="-TractorStrength" property="positionX" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana +Y" id_arme="826a785c-2f30-43fe-9433-9e746168d848" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Diana" comparator="LESS" value="StationY + 50" />
    <addto_object_property value="TractorStrength" property="positionY" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -Y" id_arme="be0fce18-a5c4-41bd-b440-7352569821b2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Diana" comparator="GREATER" value="StationY + 50" />
    <addto_object_property value="-TractorStrength" property="positionY" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana +Z" id_arme="696002d2-3797-46a5-969c-8691f20e8b17" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Diana" comparator="LESS" value="StationZ" />
    <addto_object_property value="TractorStrength" property="positionZ" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -Z" id_arme="893633db-4fe5-45f6-b781-45e559492138" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Diana" comparator="GREATER" value="StationZ" />
    <addto_object_property value="-TractorStrength" property="positionZ" name="Diana" />
  </event>
  <event name="BS5: Diana back at DS1" id_arme="e43560a1-938f-41fe-a723-b5fb16d70b54" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="150.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <log text="Diana back at DS1" />
    <set_variable name="BoardingState" value="5.0" />
  </event>
  <event name="Disable Diana impulse and turning" id_arme="994e81e4-ff2f-48c8-90e8-092bec8a176b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_exists name="Diana" />
    <if_variable name="BoardingState" comparator="EQUALS" value="5.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <clear_ai name="Diana" />
    <set_ship_text name="Diana" scan_desc="The Diana is unmanned, and is undergoing reconstruction." hailtext="We have nothing to say." />
    <!--The DamCon team is now just part of station repair personnel, so mark the Diana as unmanned again.-->
  </event>
</mission_data>