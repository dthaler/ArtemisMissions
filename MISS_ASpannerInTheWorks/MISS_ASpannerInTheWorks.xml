<mission_data version="2.7" background_id_arme="84327810-6e7d-41e7-9e71-391649f5b452" playerShipNames_arme="Artemis\Intrepid\Aegis\Horatio\Excalibur\Hera\Ceres\Diana">
  <mission_description>The crippled TSN Diana is now undergoing reconstruction at DS1, but the recent mission to recover it has attracted unwanted attention from the Arvonian fleets which are now advancing on DS1.  Your mission is to protect both DS1 and the Diana from the Arvonian invasion.^^This mission is a sequel to "The Diana Operation".</mission_description>
  <start id_arme="84327810-6e7d-41e7-9e71-391649f5b452">
    <big_message title="A Spanner in the Works" subtitle1="A Diana Series Mission by Dave Thaler" subtitle2="An adventure for one or two ships for Artemis 2.6 or 2.7" />
    <set_skybox_index index="10" />
    <set_object_property property="musicObjectMasterVolume" value="0.0" />
    <set_variable name="RapierHelpStage" value="0.0" />
    <set_variable name="RapierTractoredBy" value="0.0" />
    <set_variable name="SabotageDelaySeconds" value="300.0" />
    <!---->
    <!--Create terrain-->
    <!---->
    <create count="200" type="asteroids" startX="90000.0" startY="0.0" startZ="38699.0" endX="10000.0" endY="0.0" endZ="28699.0" randomRange="20000" randomSeed="100" />
    <create count="200" type="asteroids" startX="90000.0" startY="200.0" startZ="38699.0" endX="10000.0" endY="200.0" endZ="28699.0" randomRange="20000" randomSeed="200" />
    <create count="200" type="asteroids" startX="90000.0" startY="-200.0" startZ="38699.0" endX="10000.0" endY="-200.0" endZ="28699.0" randomRange="20000" randomSeed="300" />
    <create count="200" type="asteroids" startX="90000.0" startY="-400.0" startZ="38699.0" endX="10000.0" endY="-400.0" endZ="28699.0" randomRange="20000" randomSeed="400" />
    <create count="200" type="asteroids" startX="90000.0" startY="400.0" startZ="38699.0" endX="10000.0" endY="400.0" endZ="28699.0" randomRange="20000" randomSeed="500" />
    <!---->
    <!--Create allied ships-->
    <!---->
    <create type="player" x="48206.0" y="0.0" z="87373.0" angle="0" name="Artemis" />
    <!--DS1-->
    <set_variable name="StationX" value="27764.0" />
    <set_variable name="StationY" value="0.0" />
    <set_variable name="StationZ" value="73016.0" />
    <create type="station" x="StationX" y="StationY" z="StationZ" angle="0" name="DS1" raceKeys="friendly" hullKeys="Deep Space Base base" />
    <set_variable name="TractorStrength" value="2.0" />
    <set_variable name="DS1UpgradeMissionDelay" randomIntLow="150" randomIntHigh="300" />
    <set_timer name="DS1UpgradeMissionTimer" seconds="DS1UpgradeMissionDelay" />
    <create type="neutral" x="StationX - 10" y="StationY + 50.0" z="StationZ" angle="0" name="Diana" hullID="0" sideValue="2" />
    <!--Science Vessel: Starseeker-->
    <create type="neutral" x="14553.0" y="0.0" z="10484.0" angle="200" name="Starseeker" raceKeys="Terran friendly" hullKeys="science" sideValue="2" />
    <clear_ai name="Starseeker" />
    <add_ai type="PROCEED_TO_EXIT" name="Starseeker" />
    <set_ship_text name="Starseeker" hailtext="We're studying the BioMech wildlife in this sector." />
    <set_variable name="StarseekerDataDelay" randomIntLow="120" randomIntHigh="600" />
    <set_timer name="StarseekerDataTimer" seconds="StarseekerDataDelay" />
    <!--Bulk Cargo: Pegasus-->
    <create type="neutral" x="98378.0" y="0.0" z="64527.0" angle="75" name="Pegasus" raceKeys="Terran friendly" hullKeys="cargo" sideValue="2" />
    <clear_ai name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="Our engines have broken down! Could you lend us a DamCon team to conduct repairs?" />
    <set_variable name="PegasusCommsDelay" randomIntLow="120" randomIntHigh="600" />
    <set_timer name="PegasusCommsTimer" seconds="PegasusCommsDelay" />
    <!--Luxury Liner: Avalon-->
    <create type="neutral" x="4964.0" y="0.0" z="96198.0" angle="0" name="Avalon" raceKeys="Terran friendly" hullKeys="luxury" sideValue="2" />
    <clear_ai name="Avalon" />
    <set_variable name="AvalonCommsDelay" randomIntLow="120" randomIntHigh="600" />
    <set_ship_text name="Avalon" hailtext="We're out of energy!  Could you lend us 200 units to get moving?" />
    <set_timer name="AvalonCommsTimer" seconds="AvalonCommsDelay" />
    <!--Transport: Atlas-->
    <create type="neutral" x="70339.0" y="0.0" z="81815.0" angle="45" name="Atlas" raceKeys="Terran friendly" hullKeys="transport" sideValue="2" />
    <clear_ai name="Atlas" />
    <add_ai type="PROCEED_TO_EXIT" name="Atlas" />
    <!--Destroyer: Rapier-->
    <create type="neutral" x="4093.0" y="0.0" z="46077.0" angle="320" name="Rapier" raceKeys="Terran friendly" hullKeys="medium" sideValue="2" />
    <clear_ai name="Rapier" />
    <add_ai type="DIR_THROTTLE" value1="320" value2="1.0" name="Rapier" />
    <set_ship_text name="Rapier" hailtext="Our sensors are all down!  We're flying blind. Please guide us to a station for repairs!" />
    <set_variable name="RapierCommsDelay" randomIntLow="60" randomIntHigh="180" />
    <set_timer name="RapierCommsTimer" seconds="RapierCommsDelay" />
    <!---->
    <!--Create monsters-->
    <!---->
    <create type="enemy" x="7289.0" y="10.0" z="28789.0" angle="0" name="B01" hullID="6001" sideValue="0" />
    <clear_ai name="B01" />
    <add_ai type="TARGET_THROTTLE" value1="1.0" targetName="Starseeker" value2="10.0" name="B01" />
    <add_ai type="CHASE_ANGER" name="B01" />
    <!--Add some NSECT monsters. More will be created when a second ship spawns.-->
    <!--Coordinates should fit within asteroid field.  MonsterZStart is the Z coordinate at X=20000 on the asteroid belt center line.-->
    <set_variable name="MonsterZStart" value="29949.0" />
    <!---->
    <!--Initialize any variables that must be integers:-->
    <!---->
    <set_variable name="ShipTransferRange" value="400.0" integer="yes" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <set_variable name="HackSuccessesNeeded" value="5.0" integer="yes" />
    <set_variable name="DamConTeamSent" value="0.0" integer="yes" />
    <set_variable name="HackStepsSucceeded" value="0.0" integer="yes" />
    <set_variable name="BombsSet" value="0.0" integer="yes" />
    <set_variable name="MaxBombs" value="1.0" integer="yes" />
    <set_variable name="PlayerShipCount" value="0.0" integer="yes" />
    <set_variable name="NSectCount" value="0.0" integer="yes" />
    <set_variable name="SkaraanCount" value="0.0" integer="yes" />
  </start>
  <folder_arme name="Initialization" id_arme="6ef97816-b707-4333-8e81-c10c250bf89b" />
  <event name="Disable Diana impulse and turning" id_arme="519bff8f-c77c-4692-b182-acda4ba82a5b" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="0.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <clear_ai name="Diana" />
    <!--Face north-->
    <set_object_property property="angle" value="3.14" name="Diana" />
    <set_ship_text name="Diana" scan_desc="The Diana is unmanned, and is undergoing reconstruction." />
  </event>
  <event name="Raise frequency A" id_arme="56e373d7-757d-4ee8-80f0-1a1fdfd92470" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength0" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency B" id_arme="a536a299-19b2-4f8a-a284-eea0f0e4b4be" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength1" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency C" id_arme="e8a54454-0838-4444-9361-9de10c992a38" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength2" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency D" id_arme="ddc2a914-96b9-4977-9510-10e1c80f72f8" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength3" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency E" id_arme="c2be3237-397a-47a4-914f-1bbde409b157" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength4" value="TempRandom" name="Diana" />
  </event>
  <event name="Lower frequency A" id_arme="50be9f21-8f6d-405f-8e8c-e98a3756517f" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength0" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency B" id_arme="5749b266-8f7c-40a2-88a4-1f11d35295ef" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength1" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency C" id_arme="e04c0fb3-2579-4955-9e63-7c0f9ba45140" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength2" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency D" id_arme="c9bc2b97-e951-4d12-89cb-67e1cef2e04c" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength3" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency E" id_arme="6cdf3470-cbbb-438e-8243-ad94c96f8cc1" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength4" value="0.5" name="Diana" />
  </event>
  <event name="Create Skaraan" id_arme="454afe64-1060-451d-8b4f-94d9363b2ed2" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_difficulty comparator="GREATER" value="SkaraanCount + 1" />
    <set_variable name="SkaraanCount" value="SkaraanCount + 1" />
    <set_variable name="RandomX" randomFloatLow="20000.0" randomFloatHigh="90000.0" />
    <set_variable name="RandomZ" value="RandomZpiece + ((RandomX - 20000) / 8)" />
    <set_variable name="RandomZpiece" randomIntLow="(MonsterZStart - 15000)" randomIntHigh="(MonsterZStart + 15000)" />
    <log text="Creating Skaraan SK|SkaraanCount| at (|RandomX|, 0, |RandomZ|)" />
    <create type="enemy" x="RandomX" y="0.0" z="RandomZ" angle="0" name="SK|SkaraanCount|" raceKeys="Skaraan enemy hasspecials" hullKeys="small medium large" fleetnumber="10 + SkaraanCount" />
  </event>
  <event name="Create NSect" id_arme="a7bad8c2-290c-4d64-9120-63678039a259" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_variable name="NSectCount" comparator="LESS" value="PlayerShipCount * 2" />
    <!--Add some more NSECT monsters-->
    <set_variable name="NSectCount" value="NSectCount + 1" />
    <set_variable name="RandomX" randomFloatLow="20000.0" randomFloatHigh="90000.0" />
    <set_variable name="RandomZ" value="RandomZpiece + ((RandomX - 20000) / 8)" />
    <set_variable name="RandomZpiece" randomIntLow="(MonsterZStart - 15000)" randomIntHigh="(MonsterZStart + 15000)" />
    <create type="monster" monsterType="6" x="RandomX" y="0.0" z="RandomZ" angle="0" name="NSECT|NSectCount|" />
    <set_monster_tag_data tag_slot="0" name="NSECT|NSectCount|" />
  </event>
  <disabled_event name="2 MaxBombs" id_arme="a457ad0c-fda4-4b35-a5ce-2f1b47b821ab" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_variable name="MaxBombs" comparator="LESS" value="2.0" />
    <if_difficulty comparator="GREATER" value="5.0" />
    <set_variable name="MaxBombs" value="2.0" integer="yes" />
  </disabled_event>
  <folder_arme name="Start/End Game Events" id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1" />
  <event name="All Player Ships Destroyed" id_arme="42f2865c-0518-4e1b-bfc1-7556bdc0cd1b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="Aegis" />
    <if_not_exists name="Artemis" />
    <if_not_exists name="Intrepid" />
    <if_not_exists name="Horatio" />
    <if_not_exists name="Excalibur" />
    <if_not_exists name="Hera" />
    <if_not_exists name="Ceres" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <log text="FAILED because all player ships destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="All player ships have been destroyed" />
    <incoming_comms_text from="Main Screen" type="ALERT">Mission Failed^All player ships have been destroyed</incoming_comms_text>
  </event>
  <event name="End Game" id_arme="2f1aab6d-e5c1-489e-8dcd-e39c4660c27f" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="GameOver" comparator="EQUALS" value="1" />
    <if_timer_finished name="GameFinishedTimer" />
    <log text="End Game" />
    <end_mission />
  </event>
  <event name="Lost DS1" id_arme="b526982b-a60f-4850-8902-f0c9525953a5" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="DS1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0" />
    <log text="FAILED because all player bases destroyed" />
    <big_message title="MISSION FAILED" subtitle1="All player bases have been destroyed" />
    <incoming_comms_text from="Main Screen" type="ALERT">Mission Failed^All player bases have been destroyed</incoming_comms_text>
    <set_variable name="GameOver" value="1" />
    <set_timer name="GameFinishedTimer" seconds="15" />
  </event>
  <event name="Lost Diana" id_arme="df728465-db6c-46d4-bf37-05eebdf4c22d" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="Diana" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the Diana was destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The TSN Diana was destroyed" />
    <incoming_comms_text from="Main Screen" type="ALERT">Mission Failed^The TSN Diana has been destroyed</incoming_comms_text>
  </event>
  <event name="Diana Escaped" id_arme="94bc79ae-5517-4033-afa4-2bfcf435e031" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_inside_sphere name="Diana" centerX="68960.0" centerY="0.0" centerZ="0.0" radius="2500" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the saboteur escaped" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The saboteur escaped with the TSN Diana" />
    <incoming_comms_text from="Main Screen" type="ALERT">Mission Failed^The saboteur escaped with the TSN Diana</incoming_comms_text>
  </event>
  <event name="All enemies destroyed" id_arme="8cd2c901-c296-44f2-9e21-34a669cf027b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="AB1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_variable name="TsnCommandGaveMission" comparator="GREATER" value="1.0" />
    <if_variable name="BoardingState" comparator="GREATER_EQUAL" value="4.0" />
    <if_fleet_count comparator="EQUALS" value="0.0" sideValue="1" />
    <if_variable name="BombsSet" comparator="EQUALS" value="BombsDefused" />
    <log text="MISSION SUCCEEDED" />
    <incoming_comms_text from="TSN Command" type="STATION">Good work!  The Arvonians have abandoned their attack on DS1, at least for now.  The TSN Diana is also safe and we can now complete the renovations on her to prepare to return her to service again.^^The AI that took over the Diana seems to be of Arvonian origin, and was apparently dormant in a damaged memory bank long before the Diana was towed here to DS1.  Recent repairs to the Diana must have reawakened it.  It seems possible that it was somehow connected to the Diana's original fate from which it was rescued during the recent Diana Operation.</incoming_comms_text>
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION SUCCEEDED" subtitle1="All enemies have been destroyed" />
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="b2cb0990-403d-4203-9f02-a732053e1d82" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="LESS" value="EnemiesLeft" sideValue="1" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft - 1" />
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="3753f14f-cac2-432c-873b-68f005547932" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="GREATER" value="EnemiesLeft" sideValue="1" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft + 1" />
  </event>
  <event name="Limit sensor range" id_arme="51449eef-be71-441f-90b7-d3a39fe8ae40" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_object_property property="sensorSetting" comparator="EQUALS" value="0.0" />
    <set_object_property property="sensorSetting" value="2" />
  </event>
  <event name="Report sensor range 33k" id_arme="839700f3-5592-475d-ac17-5aa0aea17490" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_object_property property="sensorSetting" comparator="EQUALS" value="1.0" />
    <if_variable name="ReportedSensorRange" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <set_variable name="ReportedSensorRange" value="1.0" />
    <warning_popup_message message="Sensor range limited to 33k" consoles="S" />
  </event>
  <event name="Report sensor range 16k" id_arme="ce2a3e84-28f1-4442-9bff-78960d1a6424" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_object_property property="sensorSetting" comparator="EQUALS" value="2.0" />
    <if_variable name="ReportedSensorRange" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <set_variable name="ReportedSensorRange" value="1.0" />
    <warning_popup_message message="Sensor range limited to 16k" consoles="S" />
  </event>
  <event name="Report sensor range 11k" id_arme="c98dc60d-87f6-4e3e-8215-ae3a31a06814" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_object_property property="sensorSetting" comparator="EQUALS" value="3.0" />
    <if_variable name="ReportedSensorRange" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <set_variable name="ReportedSensorRange" value="1.0" />
    <warning_popup_message message="Sensor range limited to 11k" consoles="S" />
  </event>
  <event name="Report sensor range 8k" id_arme="5979b578-ffd3-499f-957d-d192fc8b9ced" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_object_property property="sensorSetting" comparator="EQUALS" value="4.0" />
    <if_variable name="ReportedSensorRange" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <set_variable name="ReportedSensorRange" value="1.0" />
    <warning_popup_message message="Sensor range limited to 8k" consoles="S" />
  </event>
  <folder_arme name="Player Ship initialization" id_arme="21712616-42f1-44fc-a39e-b0521eb9312f" />
  <event name="Create Player Ship - Artemis" id_arme="77054e94-9150-490c-b841-a94b75764284" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Artemis" />
    <if_variable name="ArtemisInitialized" comparator="EQUALS" value="0" />
    <log text="Artemis spawned" />
    <set_object_property property="missileStoresHoming" value="16" name="DS1" />
    <set_object_property property="missileStoresNuke" value="4" name="DS1" />
    <set_object_property property="missileStoresMine" value="12" name="DS1" />
    <set_object_property property="missileStoresECM" value="8" name="DS1" />
    <set_object_property property="missileStoresPShock" value="4" name="DS1" />
    <set_object_property property="positionX" value="48206.0" name="Artemis" />
    <set_object_property property="positionY" value="0" name="Artemis" />
    <set_object_property property="positionZ" value="87373.0" name="Artemis" />
    <set_object_property property="angle" value="3.1416" name="Artemis" />
    <set_variable name="ArtemisInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
  </event>
  <event name="Create Player Ship - Intrepid" id_arme="37715cd5-a873-452b-9b03-0409dab65292" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Intrepid" />
    <if_variable name="IntrepidInitialized" comparator="EQUALS" value="0" />
    <log text="Intrepid spawned" />
    <set_object_property property="positionX" value="42591.0" name="Intrepid" />
    <set_object_property property="positionY" value="0" name="Intrepid" />
    <set_object_property property="positionZ" value="92130.0" name="Intrepid" />
    <set_object_property property="angle" value="3.1416" name="Intrepid" />
    <set_variable name="IntrepidInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
    <!--Add some more missiles to DS1-->
    <addto_object_property value="8.0" property="missileStoresHoming" name="DS1" />
    <addto_object_property value="2.0" property="missileStoresNuke" name="DS1" />
    <addto_object_property value="6.0" property="missileStoresMine" name="DS1" />
    <addto_object_property value="4.0" property="missileStoresECM" name="DS1" />
    <addto_object_property value="5.0" property="missileStoresPShock" name="DS1" />
    <!--Add a Dragon-->
    <!--<create type="monster" monsterType="3" z="40702.0" x="99831.0" angle="0" name="DRAGON" y="0.0" />-->
    <!--<set_monster_tag_data tag_slot="0" name="DRAGON" />-->
  </event>
  <event name="Create Player Ship - Aegis" id_arme="6e63775f-221a-4740-beb5-76207cb60034" parent_id_arme="21712616-42f1-44fc-a39e-b0521eb9312f">
    <if_exists name="Aegis" />
    <if_variable name="AegisInitialized" comparator="EQUALS" value="0" />
    <log text="Aegis spawned" />
    <set_object_property property="positionX" value="20503" name="Aegis" />
    <set_object_property property="positionZ" value="79253" name="Aegis" />
    <set_object_property property="positionY" value="0" name="Aegis" />
    <set_object_property property="angle" value="0.0" name="Aegis" />
    <set_variable name="AegisInitialized" value="1" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount+1" integer="yes" />
  </event>
  <folder_arme name="Task: Dock with DS1 to receive orders" id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6" />
  <event name="Prepare to summon ships" id_arme="b5f53049-5cf3-43b7-b98d-6a92f25d26f1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="0.0" />
    <log text="Delaying before summoning ships" />
    <set_variable name="TsnCommandSummonedShips" value="1.0" />
    <set_timer name="RefreshGMButtons" seconds="1" />
    <set_timer name="StartupDelayBeforeOrders" seconds="10" />
  </event>
  <event name="TSN Command summons ships" id_arme="db11b82c-2c75-4dfb-b2e1-fef7eb5c91b4" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="ALERT STATION">All TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders.</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="2.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="300" />
    <set_timer name="StartupDelayBeforeOrders" seconds="120" />
  </event>
  <event name="TSN Command summons ships again" id_arme="7c3e3147-e599-4707-afd7-a957d9ce8684" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="ALERT STATION">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
  </event>
  <event name="GM summons ships again" id_arme="92f4ecc2-d839-4ba1-b5f4-8d35ddfeeac1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="ALERT STATION">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="300" />
  </event>
  <event name="Mission Failed - Out of time" id_arme="875dc7e9-9018-49d1-8750-bd76aa7f387d" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0" />
    <if_timer_finished name="ShipsDueAtCommandBase" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="Did not receive missions orders in time" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="You did not follow orders from TSN Command in time" />
    <incoming_comms_text from="TSN Command" type="ALERT STATION">You did not follow orders from TSN Command in time!</incoming_comms_text>
  </event>
  <event name="Task Succeeded - 1 Ship Docked" id_arme="179e7ae6-25f8-46c5-8916-6995e3c73883" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="1.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_exists name="Artemis" />
    <if_docked player_name="Artemis" name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Task Succeeded - 2 Ships Docked" id_arme="3c75cb0b-7be9-4c70-b4da-c32d8d05e60c" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="2.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_exists name="Artemis" />
    <if_exists name="Intrepid" />
    <if_docked player_name="Artemis" name="DS1" />
    <if_docked player_name="Intrepid" name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Task Succeeded - 3 Ships Docked" id_arme="bee1aff2-7bd6-4346-a020-863841bbeb14" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER_EQUAL" value="3.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_exists name="Artemis" />
    <if_exists name="Intrepid" />
    <if_exists name="Aegis" />
    <if_docked player_name="Artemis" name="DS1" />
    <if_docked player_name="Intrepid" name="DS1" />
    <if_docked player_name="Aegis" name="DS1" />
    <log text="TSN Command issued mission orders" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="GM give mission" id_arme="c8c38a14-899f-4b30-9010-52298c0fde64" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/Give Mission" />
    <log text="GM gave mission" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
  </event>
  <event name="Give mission" id_arme="d1a783c8-8781-4cbe-95ae-4baa520c39a5" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="1.0" />
    <log text="Gave mission" />
    <incoming_comms_text from="TSN Command" type="ALERT STATION">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an assault on DS1.  We are sending their position to your ship now.  Your primary mission is to protect both DS1 and the Diana from the Arvonian invasion.  It is imperative that we not lose either one.</incoming_comms_text>
    <incoming_comms_text from="TSN Command" type="STATION">Most Terran ships have already evacuated, but a few stragglers remain for whatever reason.  Your secondary mission is to protect the remaining friendly ships as much as possible without compromising your primary mission.</incoming_comms_text>
    <set_variable name="TsnCommandGaveMission" value="2.0" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <create type="station" x="68960.0" y="0.0" z="20741.0" angle="0" name="AB1" raceKeys="enemy whalelover" hullKeys="base" sideValue="1" />
    <create type="enemy" x="83996.0" y="0.0" z="20217.0" angle="180" hullID="3002" fleetnumber="1" />
    <create type="enemy" x="34630.0" y="0.0" z="33068.0" angle="180" hullID="3002" fleetnumber="2" />
    <create type="enemy" x="62494.0" y="0.0" z="33292.0" angle="180" hullID="3002" fleetnumber="3" />
    <create type="enemy" x="85739.0" y="0.0" z="20072.0" angle="180" hullID="3001" fleetnumber="1" />
    <create type="enemy" x="33293.0" y="0.0" z="33292.0" angle="180" hullID="3001" fleetnumber="2" />
    <create type="enemy" x="60606.0" y="0.0" z="33292.0" angle="180" hullID="3001" fleetnumber="3" />
    <create type="enemy" x="67579.0" y="0.0" z="21234.0" angle="180" name="A12" hullID="3001" fleetnumber="7" />
    <clear_ai name="A12" />
    <add_ai type="GUARD_STATION" value1="20" name="A12" />
    <add_ai type="CHASE_AI_SHIP" value1="3000" value2="500" name="A12" />
    <add_ai type="CHASE_PLAYER" value1="3000" value2="500" name="A12" />
    <add_ai type="CHASE_ANGER" name="A12" />
    <add_ai type="LAUNCH_FIGHTERS" value1="11000" name="A12" />
  </event>
  <event name="Add enemies for 2nd ship" id_arme="e67adc38-f742-404e-9352-b1e0797d6519" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="1.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="2.0" />
    <log text="Added enemies for 2nd ship" />
    <set_variable name="TsnCommandGaveMission" value="3.0" />
    <create type="enemy" x="58427.0" y="0.0" z="14116.0" angle="180" hullID="3002" fleetnumber="4" />
    <create type="enemy" x="77022.0" y="0.0" z="34019.0" angle="180" hullID="3002" fleetnumber="5" />
    <create type="enemy" x="49129.0" y="0.0" z="27336.0" angle="180" hullID="3002" fleetnumber="6" />
    <create type="enemy" x="59734.0" y="0.0" z="13389.0" angle="180" hullID="3002" fleetnumber="4" />
    <create type="enemy" x="78039.0" y="0.0" z="33583.0" angle="180" hullID="3002" fleetnumber="5" />
    <create type="enemy" x="50291.0" y="0.0" z="26900.0" angle="180" hullID="3002" fleetnumber="6" />
  </event>
  <event name="Clear GM buttons" id_arme="1878597c-8874-4fad-97a3-f6071b4b9adb" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_timer_finished name="RefreshGMButtons" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Side Mission/BioMech Study" />
    <clear_gm_button text="GM/Side Mission/Help Atlas" />
    <clear_gm_button text="GM/Side Mission/Help Avalon" />
    <clear_gm_button text="GM/Side Mission/Help DS1 Nukes" />
    <clear_gm_button text="GM/Side Mission/Help DS1 Upgrade" />
    <clear_gm_button text="GM/Side Mission/Help Pegasus" />
    <clear_gm_button text="GM/Side Mission/Help Rapier" />
    <clear_gm_button text="GM/Side Mission/Help Starseeker" />
  </event>
  <event name="Refresh GM buttons" id_arme="b6556827-1bda-406e-b769-606e7aade0c5" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_exists name="DS1" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <set_gm_button text="GM/Resend Comms/Give Mission" />
  </event>
  <folder_arme name="Side missions" id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <folder_arme name="Side mission: Rapier" id_arme="a7e826ad-d40c-4a39-8248-01183453befa" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" expanded_arme="" />
  <event name="Refresh GM button" id_arme="20765da5-aadc-47af-b6b3-d1e74038966a" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_exists name="Rapier" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help Rapier" />
  </event>
  <event name="GM button pressed" id_arme="7e76ae62-bf2e-47f7-81dd-7a49e653fba3" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_gm_button text="GM/Side Mission/Help Rapier" />
    <log text="GM started Rapier side mission" />
    <clear_gm_button text="GM/Side Mission/Help Rapier" />
    <set_timer name="RapierCommsTimer" seconds="1" />
  </event>
  <event name="Rapier asks for help" id_arme="c3cb45b0-fe02-4eb3-bac0-b1ed8852de8d" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="RapierCommsTimer" />
    <if_exists name="Rapier" />
    <log text="Rapier asked for help" />
    <incoming_comms_text from="Destroyer Rapier" type="SIDE FRIEND">Our sensors are all down!  We're flying blind. Please come tractor us back to a station for repairs.</incoming_comms_text>
    <set_variable name="RapierHelpStage" value="1.0" />
  </event>
  <event name="Artemis starts tractoring Rapier" id_arme="659eca7d-86ec-4827-bbb4-04639483f1f8" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="1.0" />
    <if_variable name="RapierTractoredBy" comparator="EQUALS" value="0.0" />
    <if_distance name1="Rapier" name2="Artemis" comparator="LESS_EQUAL" value="220.0" />
    <log text="Artemis starts tractoring Rapier" />
    <incoming_comms_text from="Destroyer Rapier" type="SIDE FRIEND">Thanks for the assistance Artemis, we're ready for you to tow us back to DS1.</incoming_comms_text>
    <warning_popup_message message="Tractor beam locked onto Rapier" consoles="W" name="Artemis" />
    <add_ai type="TARGET_THROTTLE" value1="1.0" targetName="Artemis" value2="1" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="1.0" />
  </event>
  <event name="Rapier following Artemis" id_arme="b07c0dc6-df6c-4016-b6a7-357b00ae8105" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="1.0" />
    <if_variable name="RapierTractoredBy" comparator="EQUALS" value="1.0" />
    <!--This makes it so that the tractor only turns on when you are facing away from your target-->
    <if_distance name1="Rapier" name2="Artemis" comparator="GREATER" value="220.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="GREATER" value="600.0" />
    <set_relative_position name2="Rapier" distance="220" angle="180" name1="Artemis" />
  </event>
  <event name="Intrepid starts tractoring Rapier" id_arme="e25aafee-a19a-4148-b860-8b51a2a4d223" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="1.0" />
    <if_variable name="RapierTractoredBy" comparator="EQUALS" value="0.0" />
    <if_distance name1="Rapier" name2="Intrepid" comparator="LESS_EQUAL" value="220.0" />
    <log text="Intrepid starts tractoring Rapier" />
    <incoming_comms_text from="Destroyer Rapier" type="SIDE FRIEND">Thanks for the assistance Intrepid, we're ready for you to tow us back to DS1.</incoming_comms_text>
    <warning_popup_message message="Tractor beam locked onto Rapier" consoles="W" name="Intrepid" />
    <add_ai type="TARGET_THROTTLE" value1="1.0" targetName="Intrepid" value2="1" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="2.0" />
  </event>
  <event name="Rapier following Intrepid" id_arme="6781b435-4839-43a3-bf96-60510c3803d7" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="1.0" />
    <if_variable name="RapierTractoredBy" comparator="EQUALS" value="2.0" />
    <!--This makes it so that the tractor only turns on when you are facing away from your target-->
    <if_distance name1="Rapier" name2="Intrepid" comparator="GREATER" value="220.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="GREATER" value="600.0" />
    <set_relative_position name2="Rapier" distance="220" angle="180" name1="Intrepid" />
  </event>
  <event name="DS1 Tractoring Diana +X" id_arme="a6b726cb-f9db-45a2-bd80-4d146eaf37ac" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Rapier" comparator="LESS" value="StationX" />
    <addto_object_property value="TractorStrength" property="positionX" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="DS1 Tractoring Diana -X" id_arme="c631ee0a-969c-471a-97c8-5c994b5c08ad" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Rapier" comparator="GREATER" value="StationX" />
    <addto_object_property value="-TractorStrength" property="positionX" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="DS1 Tractoring Diana +Y" id_arme="32178376-da48-4531-939a-bbbe854519c4" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Rapier" comparator="LESS" value="StationY + 50" />
    <addto_object_property value="TractorStrength" property="positionY" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="DS1 Tractoring Diana -Y" id_arme="361d5410-0a7e-4b33-b18a-5e0129967d41" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Rapier" comparator="GREATER" value="StationY + 50" />
    <addto_object_property value="-TractorStrength" property="positionY" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="DS1 Tractoring Diana +Z" id_arme="5668c413-3928-4020-b715-4e13fc85d7c7" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Rapier" comparator="LESS" value="StationZ" />
    <addto_object_property value="TractorStrength" property="positionZ" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="DS1 Tractoring Diana -Z" id_arme="486d05e6-95de-43e9-9c49-c1835097f677" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="LESS_EQUAL" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Rapier" comparator="GREATER" value="StationZ" />
    <addto_object_property value="-TractorStrength" property="positionZ" name="Rapier" />
    <set_variable name="RapierTractoredBy" value="99.0" />
    <clear_ai name="Rapier" />
  </event>
  <event name="Rapier reaches DS1" id_arme="a96b73e6-6360-4bc7-851d-00e805b18b31" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Rapier" name2="DS1" comparator="LESS_EQUAL" value="150.0" />
    <log text="Rapier reached DS1" />
    <set_variable name="RapierHelpStage" value="2.0" />
    <incoming_comms_text from="Destroyer Rapier" type="SIDE FRIEND">We made it back to DS1 and our sensors are fixed.  We're ready to help.</incoming_comms_text>
    <set_ship_text name="Rapier" hailtext="We're ready to help." />
    <clear_ai name="Rapier" />
    <add_ai type="CHASE_AI_SHIP" name="Rapier" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Rapier" />
    <add_ai type="DEFEND" value1="1000" value2="3000" name="Rapier" />
    <add_ai type="CHASE_ANGER" name="Rapier" />
  </event>
  <event name="Prevent Rapier from attacking Diana" id_arme="d08f056b-14f4-45a1-87f6-0f6c51797536" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierHelpStage" comparator="EQUALS" value="2.0" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_distance name1="Rapier" name2="Diana" comparator="LESS_EQUAL" value="3000.0" />
    <if_variable name="RapierFollowingDiana" comparator="EQUALS" value="0.0" />
    <log text="Rapier is following the rogue Diana" />
    <set_variable name="RapierFollowingDiana" value="1.0" />
    <clear_ai name="Rapier" />
    <add_ai type="TARGET_THROTTLE" value1="1.0" targetName="Diana" value2="1" name="Rapier" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Rapier" />
    <set_ship_text name="Rapier" hailtext="We're following the Diana, do you know what's going on?" />
  </event>
  <event name="Rapier returning to duty" id_arme="7d325b79-4866-4678-ad74-691855738900" parent_id_arme="a7e826ad-d40c-4a39-8248-01183453befa">
    <if_variable name="RapierFollowingDiana" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Diana" comparator="NOT" value="1.0" />
    <log text="Rapier returning to normal duty" />
    <set_variable name="RapierFollowingDiana" value="0.0" />
    <set_ship_text name="Rapier" hailtext="Patrolling this sector.  Standing by to assist." />
    <clear_ai name="Rapier" />
    <add_ai type="CHASE_AI_SHIP" name="Rapier" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Rapier" />
    <add_ai type="DEFEND" value1="1000" value2="3000" name="Rapier" />
    <add_ai type="CHASE_ANGER" name="Rapier" />
  </event>
  <folder_arme name="Side mission: Avalon" id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="bf428982-7d57-4feb-ad54-739c1cc1afff" parent_id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e">
    <if_exists name="Avalon" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="AvalonHelpStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help Avalon" />
  </event>
  <event name="GM button pressed" id_arme="ec144357-39a9-4916-bc09-d8943271b35b" parent_id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e">
    <if_gm_button text="GM/Side Mission/Help Avalon" />
    <log text="GM started Avalon side mission" />
    <clear_gm_button text="GM/Side Mission/Help Avalon" />
    <set_timer name="AvalonCommsTimer" seconds="1" />
  </event>
  <event name="Avalon asks for help" id_arme="b24d24ac-08b8-4ad2-856d-d30608afad93" parent_id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e">
    <if_variable name="AvalonHelpStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="AvalonCommsTimer" />
    <if_exists name="Avalon" />
    <log text="Avalon asked for help" />
    <incoming_comms_text from="Luxury Liner Avalon" type="SIDE FRIEND">We're out of energy!  Could you lend us 200 units to get moving?  In return, we've give you two of our coolant units.</incoming_comms_text>
    <set_variable name="AvalonHelpStage" value="1.0" />
  </event>
  <event name="Artemis gives Avalon energy" id_arme="1e950fcb-481e-4dab-a7ba-593907b0d5b8" parent_id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e">
    <if_variable name="AvalonHelpStage" comparator="LESS" value="2.0" />
    <if_object_property property="energy" name="Artemis" comparator="GREATER" value="200.0" />
    <if_distance name1="Artemis" name2="Avalon" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis gave Avalon energy" />
    <set_variable name="AvalonHelpStage" value="2.0" />
    <addto_object_property value="-200.0" property="energy" name="Artemis" />
    <addto_object_property value="2.0" property="totalCoolant" name="Artemis" />
    <incoming_comms_text from="Luxury Liner Avalon" type="SIDE FRIEND">Thanks for the energy, Artemis!  In return, here's two of our coolant units.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Avalon" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Avalon" />
    <set_ship_text name="Avalon" hailtext="We're travelling this sector, showing our guests the most beautiful and amazing sights." />
  </event>
  <event name="Intrepid gives Avalon energy" id_arme="74f4d364-69d5-441e-b516-2f6f816a1364" parent_id_arme="1dcd0b8c-8f99-4b5b-8f55-6f4e7390217e">
    <if_variable name="AvalonHelpStage" comparator="LESS" value="2.0" />
    <if_object_property property="energy" name="Intrepid" comparator="GREATER" value="200.0" />
    <if_distance name1="Intrepid" name2="Avalon" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid gave Avalon energy" />
    <set_variable name="AvalonHelpStage" value="2.0" />
    <addto_object_property value="-200.0" property="energy" name="Intrepid" />
    <addto_object_property value="2.0" property="totalCoolant" name="Intrepid" />
    <incoming_comms_text from="Luxury Liner Avalon" type="SIDE FRIEND">Thanks for the energy, Intrepid!  In return, here's two of our coolant units.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Avalon" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Avalon" />
    <set_ship_text name="Avalon" hailtext="We're travelling this sector, showing our guests the most beautiful and amazing sights." />
  </event>
  <folder_arme name="Side mission: DS1 upgrade" id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="2b084568-1102-4c26-8e7f-0a7f28ca07a1" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_timer_finished name="RefreshGMButtons" />
    <if_exists name="Atlas" />
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help DS1 Upgrade" />
  </event>
  <event name="GM button pressed" id_arme="852173c1-7a6c-455c-90ff-32b22e81894e" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_gm_button text="GM/Side Mission/Help DS1 Upgrade" />
    <log text="GM started DS1 upgrade side mission" />
    <clear_gm_button text="GM/Side Mission/Help DS1 Upgrade" />
    <set_timer name="DS1UpgradeMissionTimer" seconds="1" />
  </event>
  <event name="DS1 offers upgrade mission" id_arme="345952d6-0657-488f-bc88-f97c031c19ab" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="DS1UpgradeMissionTimer" />
    <if_exists name="Atlas" />
    <log text="DS1 offered mission to upgrade production" />
    <incoming_comms_text from="DS1" type="SIDE STATION">For several weeks now, our engineers have also been diligently working on upgrading this station to a Command Base.  Rendezvous with the Atlas and pick up some energy generator parts we need so we can complete our upgrade, which should double our shields and production speed.</incoming_comms_text>
    <set_variable name="DS1UpgradeMissionStage" value="1.0" />
  </event>
  <event name="Artemis got DS1 upgrade parts from Atlas" id_arme="67c214b2-c3da-49f8-a9f7-04106a97864c" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Artemis" name2="Atlas" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis picked up DS1 parts from Atlas" />
    <incoming_comms_text from="Transport Atlas" type="SIDE FRIEND">Transfer complete, Artemis. Please proceed to DS1 to deliver the energy generator parts.</incoming_comms_text>
    <set_variable name="DS1UpgradeMissionStage" value="2.0" />
  </event>
  <event name="Intrepid got DS1 upgrade parts from Atlas" id_arme="72f50c50-bef8-4e28-b436-765fa4712901" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Intrepid" name2="Atlas" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid picked up DS1 parts from Atlas" />
    <incoming_comms_text from="Transport Atlas" type="SIDE FRIEND">Transfer complete, Intrepid. Please proceed to DS1 to deliver the energy generator parts.</incoming_comms_text>
    <set_variable name="DS1UpgradeMissionStage" value="3.0" />
  </event>
  <event name="Artemis delivered upgrade parts to DS1" id_arme="788a8ece-304a-47a9-8881-4bde524b8c1b" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="2.0" />
    <if_exists name="Artemis" />
    <if_docked player_name="Artemis" name="DS1" />
    <log text="Artemis delivered upgrade parts to DS1" />
    <incoming_comms_text from="DS1" type="SIDE STATION">Transfer complete, Artemis. Our upgrade is complete, and we have doubled our shields and production speed!</incoming_comms_text>
    <set_variable name="DS1UpgradeMissionStage" value="4.0" />
  </event>
  <event name="Intrepid delivered upgrade parts to DS1" id_arme="d4601bd2-9ff0-467e-9a8b-53992a8ac494" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="3.0" />
    <if_exists name="Intrepid" />
    <if_docked player_name="Intrepid" name="DS1" />
    <log text="Intrepid delivered upgrade parts to DS1" />
    <incoming_comms_text from="DS1" type="SIDE STATION">Transfer complete, Intrepid. Our upgrade is complete, and we have doubled our shields and production speed!</incoming_comms_text>
    <set_variable name="DS1UpgradeMissionStage" value="4.0" />
  </event>
  <event name="Upgrade DS1" id_arme="b0b99765-f0e7-4ccc-855f-c82f27c45f8a" parent_id_arme="1c978b6c-f7b8-40fe-8106-07aa435466e6">
    <if_variable name="DS1UpgradeMissionStage" comparator="EQUALS" value="4.0" />
    <set_variable name="DS1UpgradeMissionStage" value="99.0" />
    <!--Rename DS1 so we can replace it-->
    <create type="station" x="0.0" y="0.0" z="0.0" angle="0" name="DS1Copy" raceKeys="friendly" hullKeys="Deep Space Base base" />
    <copy_object_property property="shieldState" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="canBuild" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="missileStoresHoming" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="missileStoresNuke" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="missileStoresMine" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="missileStoresECM" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="missileStoresPShock" name1="DS1" name2="DS1Copy" />
    <copy_object_property property="angle" name1="DS1" name2="DS1Copy" />
    <destroy name="DS1" />
    <!--Create an Industrial Base to replace DS1-->
    <create type="station" x="StationX" y="StationY" z="StationZ" angle="0" name="DS1" raceKeys="friendly" hullKeys="Command Base base" />
    <copy_object_property property="shieldState" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="canBuild" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="missileStoresHoming" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="missileStoresNuke" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="missileStoresMine" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="missileStoresECM" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="missileStoresPShock" name1="DS1Copy" name2="DS1" />
    <copy_object_property property="angle" name1="DS1Copy" name2="DS1" />
    <destroy name="DS1Copy" />
  </event>
  <folder_arme name="Side mission: DS1 nukes" id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="43bc5945-14db-4234-8890-1bf5b2fe66ed" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_timer_finished name="RefreshGMButtons" />
    <if_exists name="Pegasus" />
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help DS1 Nukes" />
  </event>
  <event name="GM button pressed" id_arme="32a8a0b1-9fde-4b7f-91c2-9de0758ec194" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_gm_button text="GM/Side Mission/Help DS1 Nukes" />
    <log text="GM started DS1 nukes side mission" />
    <clear_gm_button text="GM/Side Mission/Help DS1 Nukes" />
    <set_timer name="DS1NukeMissionTimer" seconds="1" />
  </event>
  <event name="DS1 offers nukes mission" id_arme="68632c12-2226-4f27-bbb5-efe4070cc000" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="DS1NukeMissionTimer" />
    <if_exists name="Pegasus" />
    <log text="DS1 offered mission to build 2 extra nukes" />
    <incoming_comms_text from="DS1" type="SIDE STATION">Help us help you.^Rendezvous with the Pegasus and pick up some extra parts we need, and we can complete 2 extra nukes.</incoming_comms_text>
    <set_variable name="DS1NukeMissionStage" value="1.0" />
  </event>
  <event name="Artemis got DS1 nuke parts from Pegasus" id_arme="9030ce44-0775-43f5-87ae-d98ad823a0ca" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Artemis" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis picked up nuke parts from Pegasus" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Transfer complete, Artemis. Please proceed to DS1 to deliver the parts.</incoming_comms_text>
    <set_variable name="DS1NukeMissionStage" value="2.0" />
  </event>
  <event name="Intrepid got DS1 nuke parts from Pegasus" id_arme="43156111-dbd3-45de-ae26-b2ea449c4b2c" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Intrepid" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid picked up nuke parts from Pegasus" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Transfer complete, Intrepid. Please proceed to DS1 to deliver the parts.</incoming_comms_text>
    <set_variable name="DS1NukeMissionStage" value="3.0" />
  </event>
  <event name="Artemis delivered nuke parts to DS1" id_arme="e5f9ce5d-fa6a-4cc6-acf4-e974d403d439" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="2.0" />
    <if_exists name="Artemis" />
    <if_docked player_name="Artemis" name="DS1" />
    <log text="Artemis delivered nuke parts to DS1" />
    <incoming_comms_text from="DS1" type="SIDE STATION">Transfer complete, Artemis. We now have 2 additional nukes.</incoming_comms_text>
    <set_variable name="DS1NukeMissionStage" value="4.0" />
    <addto_object_property value="2.0" property="missileStoresNuke" name="DS1" />
  </event>
  <event name="Intrepid delivered nuke parts to DS1" id_arme="b029ae61-61e9-4d53-bdd2-a639309de072" parent_id_arme="122bc34c-b356-4497-b1a9-649c6b1cb5f3">
    <if_variable name="DS1NukeMissionStage" comparator="EQUALS" value="3.0" />
    <if_exists name="Intrepid" />
    <if_docked player_name="Intrepid" name="DS1" />
    <log text="Intrepid delivered nuke parts to DS1" />
    <incoming_comms_text from="DS1" type="SIDE STATION">Transfer complete, Intrepid. We now have 2 additional nukes.</incoming_comms_text>
    <set_variable name="DS1NukeMissionStage" value="4.0" />
    <addto_object_property value="2.0" property="missileStoresNuke" name="DS1" />
  </event>
  <folder_arme name="Side mission: Pegasus" id_arme="9711027e-1cab-41a6-8423-07e739133d62" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="2a985172-c4db-47a0-bc4c-2870df25620e" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_exists name="Pegasus" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="PegasusHelpStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help Pegasus" />
  </event>
  <event name="GM button pressed" id_arme="dbb6c166-9164-459d-a971-7c531f60ad8c" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_gm_button text="GM/Side Mission/Help Pegasus" />
    <log text="GM started Pegasus side mission" />
    <clear_gm_button text="GM/Side Mission/Help Pegasus" />
    <set_timer name="PegasusCommsTimer" seconds="1" />
  </event>
  <event name="Pegasus asks for help" id_arme="df3571d3-79f4-4775-97d9-c2ebf360c42d" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="PegasusCommsTimer" />
    <if_exists name="Pegasus" />
    <log text="Pegasus asked for help" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Our engines have broken down! Could you lend us a DamCon team to conduct repairs?  In return, we can give you 2 nukes.</incoming_comms_text>
    <set_variable name="PegasusHelpStage" value="1.0" />
  </event>
  <event name="Artemis gives Pegasus DamCon team 1" id_arme="305a3b18-11ad-4cb3-b67e-49701a8448c5" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Artemis" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Artemis" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis gave Pegasus DamCon team 1" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="0" name="Artemis" />
    <addto_object_property value="2.0" property="countNuke" name="Artemis" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Artemis!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <event name="Artemis gives Pegasus DamCon team 2" id_arme="4fe4426a-650e-40b2-943f-b7179c07f16e" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Artemis" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Artemis" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis gave Pegasus DamCon team 2" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="1" name="Artemis" />
    <addto_object_property value="2.0" property="countNuke" name="Artemis" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Artemis!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <event name="Artemis gives Pegasus DamCon team 3" id_arme="639c33e4-7ca1-4970-a5ab-0a80b49d66d7" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Artemis" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Artemis" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis gave Pegasus DamCon team 3" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="2" name="Artemis" />
    <addto_object_property value="2.0" property="countNuke" name="Artemis" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Artemis!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <event name="Intrepid gives Pegasus DamCon team 1" id_arme="6e9ee58c-b71d-49c6-9c15-9f4abe6faaf8" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Intrepid" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Intrepid" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid gave Pegasus DamCon team 1" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="0" name="Intrepid" />
    <addto_object_property value="2.0" property="countNuke" name="Intrepid" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Intrepid!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <event name="Intrepid gives Pegasus DamCon team 2" id_arme="1e94ae91-b739-4420-aad8-49d281886a92" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Intrepid" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Intrepid" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid gave Pegasus DamCon team 2" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="1" name="Intrepid" />
    <addto_object_property value="2.0" property="countNuke" name="Intrepid" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Intrepid!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <event name="Intrepid gives Pegasus DamCon team 3" id_arme="45b5b054-ec48-433c-ae4e-89279e84a2bb" parent_id_arme="9711027e-1cab-41a6-8423-07e739133d62">
    <if_variable name="PegasusHelpStage" comparator="LESS" value="2.0" />
    <if_damcon_members name="Intrepid" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Intrepid" name2="Pegasus" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid gave Pegasus DamCon team 3" />
    <set_variable name="PegasusHelpStage" value="2.0" />
    <set_damcon_members value="0" team_index="2" name="Intrepid" />
    <addto_object_property value="2.0" property="countNuke" name="Intrepid" />
    <incoming_comms_text from="Bulk Cargo Pegasus" type="SIDE FRIEND">Thanks for the repair team, Intrepid!  In return, here's two nukes.</incoming_comms_text>
    <add_ai type="PROCEED_TO_EXIT" name="Pegasus" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Pegasus" />
    <set_ship_text name="Pegasus" hailtext="We're moving cargo between the stations in this sector." />
  </event>
  <folder_arme name="Side mission: Atlas" id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="a82d7e37-ca80-48b2-8439-431bc9195200" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_exists name="Atlas" />
    <if_exists name="Starseeker" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/Help Atlas" />
  </event>
  <event name="GM button pressed" id_arme="68d5f1fb-180c-4cce-b2fa-5c42aff23cff" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_gm_button text="GM/Side Mission/Help Atlas" />
    <log text="GM started Atlas side mission" />
    <clear_gm_button text="GM/Side Mission/Help Atlas" />
    <set_timer name="AtlasCommsTimer" seconds="1" />
  </event>
  <event name="Atlas asks for help" id_arme="ecd477a2-7bfa-410f-ad6c-4006e9253d50" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="AtlasCommsTimer" />
    <if_exists name="Atlas" />
    <if_exists name="Starseeker" />
    <log text="Atlas asked for help" />
    <incoming_comms_text from="Transport Atlas" type="SIDE FRIEND">We'd like to get the Starseeker's data. First, rendezvous with the Starseeker and download their data. Then, rendezvous with us, and we'll enhance your shield generators.</incoming_comms_text>
    <set_variable name="AtlasHelpStage" value="1.0" />
  </event>
  <event name="Artemis got data from Starseeker" id_arme="8822a5a2-be3f-4a77-bca6-29f23888872c" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Artemis" name2="Starseeker" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <if_exists name="Atlas" />
    <log text="Artemis got data from Starseeker" />
    <incoming_comms_text from="Science Vessel Starseeker" type="SIDE FRIEND">Transfer complete, Artemis. Please proceed to the Atlas to deliver the data.</incoming_comms_text>
    <set_variable name="AtlasHelpStage" value="2.0" />
  </event>
  <event name="Intrepid got data from Starseeker" id_arme="123f52ca-741b-4370-b9b1-505b89c1baea" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="1.0" />
    <if_distance name1="Intrepid" name2="Starseeker" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <if_exists name="Atlas" />
    <log text="Intrepid got data from Starseeker" />
    <incoming_comms_text from="Science Vessel Starseeker" type="SIDE FRIEND">Transfer complete, Intrepid. Please proceed to the Atlas to deliver the data.</incoming_comms_text>
    <set_variable name="AtlasHelpStage" value="3.0" />
  </event>
  <event name="Artemis delivered data to Atlas" id_arme="cb594a87-07c4-461e-a461-94ffd124abf7" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="2.0" />
    <if_distance name1="Artemis" name2="Atlas" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis delivered data to Atlas" />
    <incoming_comms_text from="Transport Atlas" type="SIDE FRIEND">Transfer complete, Artemis. In return, we'll now enhance your shield generators.</incoming_comms_text>
    <addto_object_property value="50.0" property="shieldMaxStateFront" name="Artemis" />
    <addto_object_property value="50.0" property="shieldMaxStateBack" name="Artemis" />
    <set_variable name="AtlasHelpStage" value="4.0" />
  </event>
  <event name="Intrepid delivered data to Atlas" id_arme="f3f1b473-5cc0-4796-b07e-939a2da8f039" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="3.0" />
    <if_distance name1="Intrepid" name2="Atlas" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid delivered data to Atlas" />
    <incoming_comms_text from="Transport Atlas" type="SIDE FRIEND">Transfer complete, Intrepid. In return, we'll now enhance your shield generators.</incoming_comms_text>
    <addto_object_property value="50.0" property="shieldMaxStateFront" name="Intrepid" />
    <addto_object_property value="50.0" property="shieldMaxStateBack" name="Intrepid" />
    <set_variable name="AtlasHelpStage" value="4.0" />
  </event>
  <event name="Atlas follows orders" id_arme="a0ab9c90-7c1e-4d2f-8817-e180e58cc64b" parent_id_arme="096c8a20-33f3-414b-ab56-3e1a20dc4e8f">
    <if_variable name="AtlasHelpStage" comparator="EQUALS" value="4.0" />
    <if_exists name="Atlas" />
    <log text="Atlas will now follow orders" />
    <set_ship_text name="Atlas" hailtext="We're moving cargo between the stations in this sector." />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Atlas" />
    <set_variable name="AtlasHelpStage" value="99.0" />
  </event>
  <folder_arme name="Side mission: Starseeker" id_arme="25c18002-5184-41c0-8540-53d8f201f8d5" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264" />
  <event name="Refresh GM button" id_arme="5d367bbc-b65a-425a-b5a8-6e00aa948d4d" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_exists name="Starseeker" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="0.0" />
    <set_gm_button text="GM/Side Mission/BioMech Study" />
  </event>
  <event name="GM button pressed" id_arme="a5ce26f9-8a58-4b0c-842b-f9dd31cf868a" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_gm_button text="GM/Side Mission/BioMech Study" />
    <log text="GM completed BioMech Study" />
    <clear_gm_button text="GM/Side Mission/BioMech Study" />
    <set_timer name="StarseekerDataTimer" seconds="1" />
  </event>
  <event name="Starseeker acquires BioMech data" id_arme="e9a1e3ae-e4f8-4778-95fc-95f8645595f0" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="StarseekerDataTimer" />
    <if_exists name="Starseeker" />
    <if_exists name="B01" />
    <log text="Starseeker acquires BioMech data" />
    <incoming_comms_text from="Science Vessel Starseeker" type="FRIEND">This BioMech seems to like us. We've observed it for some time now and have some great data from our study.</incoming_comms_text>
    <clear_ai name="B01" />
    <add_ai type="TARGET_THROTTLE" value1="1.0" targetName="Starseeker" value2="10.0" name="B01" />
    <add_ai type="DEFEND" value1="1000" value2="3000" name="B01" />
    <add_ai type="CHASE_ANGER" name="B01" />
    <set_object_property property="sideValue" value="2.0" name="B01" />
    <add_ai type="FOLLOW_COMMS_ORDERS" name="Starseeker" />
    <set_timer name="AtlasCommsTimer" seconds="15" />
    <set_ship_text name="Atlas" hailtext="We'd like to get the Starseeker's data." />
    <set_variable name="StarseekerHelpDelay" randomFloatLow="120.0" randomFloatHigh="600.0" />
    <set_timer name="StarseekerHelpTimer" seconds="StarseekerHelpDelay" />
    <set_variable name="StarseekerHelpStage" value="1.0" />
  </event>
  <event name="Refresh GM button" id_arme="533b90dc-0994-45d7-8437-fc6dc582081e" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_exists name="Starseeker" />
    <if_exists name="Avalon" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="StarseekerHelpStage" comparator="LESS" value="2.0" />
    <set_gm_button text="GM/Side Mission/Help Starseeker" />
  </event>
  <event name="GM button pressed" id_arme="6c4b3192-36ab-4b51-9829-1af884c24795" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_gm_button text="GM/Side Mission/Help Starseeker" />
    <log text="GM started Starseeker side mission" />
    <clear_gm_button text="GM/Side Mission/Help Starseeker" />
    <set_timer name="StarseekerHelpTimer" seconds="1" />
  </event>
  <event name="Starseeker asks for help" id_arme="8ba1e71a-3081-4c96-984f-2fae6ed07e10" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="LESS" value="2.0" />
    <if_timer_finished name="StarseekerHelpTimer" />
    <if_exists name="Starseeker" />
    <if_exists name="Avalon" />
    <log text="Starseeker asked for help" />
    <incoming_comms_text from="Science Vessel Starseeker" type="SIDE FRIEND">Help us help you.^First, rendezvous with the Avalon and download some data we need. Then, rendezvous with us, and we'll enhance your maneuverability.</incoming_comms_text>
    <set_variable name="StarseekerHelpStage" value="2.0" />
  </event>
  <event name="Artemis got data from Avalon" id_arme="cec08989-58fb-46fd-b64f-cfcf97f1a55e" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="2.0" />
    <if_distance name1="Artemis" name2="Avalon" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <if_exists name="Starseeker" />
    <log text="Artemis got data from Avalon" />
    <incoming_comms_text from="Luxury Liner Avalon" type="SIDE FRIEND">Transfer complete, Artemis. Please proceed to the Starseeker to deliver the data.</incoming_comms_text>
    <set_variable name="StarseekerHelpStage" value="3.0" />
  </event>
  <event name="Intrepid got data from Avalon" id_arme="8af1306e-b68d-4733-b255-ebf63140f711" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="2.0" />
    <if_distance name1="Intrepid" name2="Avalon" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <if_exists name="Starseeker" />
    <log text="Intrepid got data from Avalon" />
    <incoming_comms_text from="Luxury Liner Avalon" type="SIDE FRIEND">Transfer complete, Intrepid. Please proceed to the Starseeker to deliver the data.</incoming_comms_text>
    <set_variable name="StarseekerHelpStage" value="4.0" />
  </event>
  <event name="Artemis delivered data to Starseeker" id_arme="6ea4963c-b126-458f-8f70-5b2e5a6cdd4d" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="3.0" />
    <if_distance name1="Artemis" name2="Starseeker" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Artemis delivered data to Starseeker" />
    <incoming_comms_text from="Science Vessel Starseeker" type="SIDE FRIEND">Transfer complete, Artemis. In return, we'll now enhance your maneuverability.</incoming_comms_text>
    <addto_object_property value="0.002" property="turnRate" name="Artemis" />
    <set_variable name="StarseekerHelpStage" value="99.0" />
  </event>
  <event name="Intrepid delivered data to Starseeker" id_arme="9c16c17c-28dc-4f73-a701-aa5ed6088b2d" parent_id_arme="25c18002-5184-41c0-8540-53d8f201f8d5">
    <if_variable name="StarseekerHelpStage" comparator="EQUALS" value="4.0" />
    <if_distance name1="Intrepid" name2="Starseeker" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Intrepid delivered data to Starseeker" />
    <incoming_comms_text from="Science Vessel Starseeker" type="SIDE FRIEND">Transfer complete, Intrepid. In return, we'll now enhance your maneuverability.</incoming_comms_text>
    <addto_object_property value="0.002" property="turnRate" name="Intrepid" />
    <set_variable name="StarseekerHelpStage" value="99.0" />
  </event>
  <event name="Restart GM button refresh timer" id_arme="f1383e6f-ee03-4dce-872f-9f43586e0033" parent_id_arme="9b774b87-1030-4c79-bf55-a32cfc834264">
    <if_exists name="DS1" />
    <if_timer_finished name="RefreshGMButtons" />
    <set_timer name="RefreshGMButtons" seconds="10" />
  </event>
  <folder_arme name="Sabotage" id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd" />
  <event name="Bomb Set" id_arme="9c900198-e63b-4408-9a57-32ae99e1e2ae" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="BombsDefused" />
    <if_variable name="BombsSet" comparator="LESS" value="MaxBombs" />
    <if_timer_finished name="SabotageDelay" />
    <if_variable name="ReadyToHack" comparator="EQUALS" value="0.0" />
    <log text="Bomb set!" />
    <warning_popup_message message="Urgent message from DS1" consoles="M" />
    <incoming_comms_text from="DS1" type="ALERT STATION">URGENT: Immediate assistance needed at DS1!  We must have a sabotaur at work.  We just discovered a bomb on our station in the production facility!  We need you to dock with us as soon as possible and send a team of explosives experts who can deal with it before it detonates and destroys this station!  We have deactivated our final step in building more missiles so no more will be produced until the bomb is deactivated.</incoming_comms_text>
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="0" name="DS1" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <set_variable name="BombsSet" value="BombsSet + 1" integer="yes" />
    <set_variable name="WelcomedArtemisAwayTeam" value="0.0" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="0.0" />
    <set_variable name="WelcomedAegisAwayTeam" value="0.0" />
    <set_timer name="RefreshGMBombButtons" seconds="3" />
  </event>
  <event name="Bomb detonated since no one docked" id_arme="644f8ef2-c329-4cd5-97e1-5b3977cd3b61" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <if_timer_finished name="SabotageDelay" />
    <if_variable name="WelcomedArtemisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_variable name="WelcomedIntrepidAwayTeam" comparator="EQUALS" value="0.0" />
    <log text="Bomb detonated because no one docked" />
    <clear_gm_button text="Bomb detonated" />
    <clear_gm_button text="Bomb defused" />
    <destroy name="DS1" />
    <warning_popup_message message="DS1 has been destroyed in an explosion!" consoles="M" />
  </event>
  <event name="Artemis docked" id_arme="8aaa2492-326c-413c-a6ff-b38102c6a092" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="Artemis" />
    <if_docked player_name="Artemis" name="DS1" />
    <if_variable name="WelcomedArtemisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Artemis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedArtemisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="ALERT STATION">Glad to see you, Artemis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Intrepid docked" id_arme="4e9c9d7f-1cb0-49b7-bb0d-5b8aedd79088" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="Intrepid" />
    <if_docked player_name="Intrepid" name="DS1" />
    <if_variable name="WelcomedIntrepidAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Intrepid docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="ALERT STATION">Glad to see you, Intrepid. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Aegis docked" id_arme="4138f4e7-048b-429a-8666-a49be7fe3fbf" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="Aegis" />
    <if_docked player_name="Aegis" name="DS1" />
    <if_variable name="WelcomedAegisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Aegis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedAegisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="ALERT STATION">Glad to see you, Aegis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Refresh GM buttons" id_arme="b3049e32-14ce-4187-8b89-3322cce1a2f6" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_variable name="BombsSet" comparator="GREATER" value="BombsDefused" />
    <if_timer_finished name="RefreshGMBombButtons" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_timer name="RefreshGMBombButtons" seconds="3" />
  </event>
  <event name="Bomb Defused" id_arme="552e39ad-0ac1-4fb8-abe1-490bed21d397" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb defused" />
    <log text="Bomb defused" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="1" name="DS1" />
    <set_variable name="BombsDefused" value="BombsDefused + 1" />
    <incoming_comms_text from="DS1" type="STATION">Congratulations, the bomb has been defused and our production facility has resumed operation!</incoming_comms_text>
    <set_variable name="DS1NukeMissionDelay" randomIntLow="60" randomIntHigh="180" />
    <set_timer name="DS1NukeMissionTimer" seconds="DS1NukeMissionDelay" />
    <!---->
    <!--Schedule another sabotage attempt-->
    <!---->
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
  </event>
  <event name="Bomb Detonated" id_arme="486a7bdd-b0de-4d0e-ac93-723e5902f137" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb detonated" />
    <log text="Bomb detonated!" />
    <clear_gm_button text="Bomb detonated" />
    <clear_gm_button text="Bomb defused" />
    <destroy name="DS1" />
    <warning_popup_message message="DS1 has been destroyed in an explosion!" consoles="M" />
  </event>
  <folder_arme name="Escape" id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55" />
  <event name="Ready to escape" id_arme="3d4352b3-37f1-405a-b323-55357faac490" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_variable name="DianaReadyToEscape" comparator="EQUALS" value="0.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="MaxBombs" />
    <log text="Saboteur about to escape" />
    <set_timer name="DianaEscapeTimer" seconds="30" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
  </event>
  <event name="Diana AI activates" id_arme="5ab5a2dd-561e-4ac8-b49a-0b96d416144e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_not_exists name="Saboteur" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="DianaEscapeTimer" />
    <if_variable name="HackStepsSucceeded" comparator="LESS" value="HackSuccessesNeeded" />
    <log text="Diana AI activates" />
    <!--Create a new ship that will become the Diana-->
    <!--We use a new ship instead of changing the side on the existing one, in order to reset the scanned level to 1.-->
    <create type="neutral" x="27754.0" y="50.0" z="73016.0" angle="0" name="Saboteur" hullID="0" sideValue="1" />
    <incoming_comms_text from="DS1" type="ALERT STATION">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</incoming_comms_text>
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_timer name="RefreshCommsButtons" seconds="30" />
  </event>
  <event name="Saboteur Diana created" id_arme="4348db9f-e7e7-4f47-a6bf-97663c7b37e7" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_exists name="Saboteur" />
    <log text="Saboteur Diana created" />
    <set_relative_position name2="Saboteur" distance="0" angle="0" name1="Diana" />
    <clear_ai name="Saboteur" />
    <set_object_property property="exitPointZ" value="0.0" name="Saboteur" />
    <set_object_property property="exitPointX" value="68960.0" name="Saboteur" />
    <destroy name="Diana" />
    <set_ship_text name="Saboteur" newname="Diana" scan_desc="Scans indicate no life signs aboard.  The saboteur must be an AI!" />
    <set_object_property property="surrenderChance" value="0" name="Diana" />
    <add_ai type="PROCEED_TO_EXIT" name="Diana" />
  </event>
  <event name="DEBUG: Allow teleporting Diana" id_arme="8886e953-9017-4f5b-a389-50554e8d1d0d" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="TeleportDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="TeleportDianaButton" value="1.0" />
    <set_gm_button text="GM/Teleport Diana" />
  </event>
  <event name="DEBUG: Teleport Diana" id_arme="118da934-bff8-448f-a242-8cef087a2007" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_gm_button text="GM/Teleport Diana" />
    <log text="GM pressed Teleport Diana" />
    <set_object_property property="positionX" value="68940.0" name="Diana" />
    <set_object_property property="positionY" value="0.0" name="Diana" />
    <set_object_property property="positionZ" value="500.0" name="Diana" />
  </event>
  <event name="DEBUG: Allow activating saboteur" id_arme="8989b6b2-c483-4886-86e8-aa5f7e993d60" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="ActivateDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="ActivateDianaButton" value="1.0" />
    <set_gm_button text="GM/Activate saboteur" />
  </event>
  <event name="DEBUG: Activate saboteur" id_arme="b35f06a9-3a65-4d3c-85de-9155572d4d5e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_gm_button text="GM/Activate saboteur" />
    <log text="GM pressed Activate saboteur" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
    <clear_gm_button text="GM/Activate saboteur" />
    <set_timer name="DianaEscapeTimer" seconds="1" />
  </event>
  <folder_arme name="Hacking" id_arme="a587676a-7998-4d34-80cd-cee990ddefc1" />
  <event name="Ready to hack" id_arme="4d8b42f5-75fa-4443-8643-59c610e9868c" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <!--One-time event to start hacking capability-->
    <if_variable name="ReadyToHack" comparator="EQUALS" value="0.0" />
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="RefreshCommsButtons" />
    <log text="Ready to hack" />
    <set_variable name="ReadyToHack" value="1.0" />
    <set_timer name="RefreshCommsButtons" seconds="10" />
    <incoming_comms_text from="Internal Comms" type="ALERT">We can try to disrupt the Diana's computer system to stop the saboteur, but we'll have to get through multiple layers of defenses.  We'll need to use its lowest shield frequency to do so.</incoming_comms_text>
  </event>
  <event name="Refresh hack buttons" id_arme="342cc4d2-3696-4a8f-b0dc-7159300c4cfe" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="ReadyToHack" comparator="EQUALS" value="1.0" />
    <if_exists name="Diana" />
    <if_timer_finished name="RefreshCommsButtons" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="HackStepsSucceeded" comparator="LESS" value="HackSuccessesNeeded" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <set_comms_button text="Hack frequency A" />
    <set_comms_button text="Hack frequency B" />
    <set_comms_button text="Hack frequency C" />
    <set_comms_button text="Hack frequency D" />
    <set_comms_button text="Hack frequency E" />
    <set_timer name="RefreshCommsButtons" seconds="10" />
  </event>
  <event name="Hack A success" id_arme="00e10622-08be-4b6e-aed9-6bc590e765ca" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack B  success" id_arme="0f9188f4-c88c-4deb-90f3-0cdf254dccf1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack C success" id_arme="fc7bb871-93e5-4eb6-aea2-16d4ed2412e6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack D success" id_arme="743278cd-bf39-4a69-8114-0939b0ef4550" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack E success" id_arme="e26e1c0d-117c-401e-8326-359c8d81b36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <if_variable name="HackResult" comparator="NOT" value="1.0" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack A fail" id_arme="42e749e3-8e4d-46d1-b52a-76ce65c15f02" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack B fail" id_arme="689261c5-02d4-4eaa-9147-c585e1d9d659" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack C fail" id_arme="0c590657-25e7-4c88-a0ed-22c734dcc005" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack D fail" id_arme="83a5ed74-685a-4943-a79c-c3b273da0d58" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack E fail" id_arme="b43d584e-f7c4-4ce2-876e-87b76ae6aab6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <if_variable name="HackResult" comparator="NOT" value="2.0" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack step failed" id_arme="21c46882-1a4b-4ba4-9006-875cf570a590" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="2.0" />
    <log text="Hack step failed" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="0.0" integer="yes" />
    <incoming_comms_text from="Internal Comms" type="ALERT">Inorrect, all computer defenses have been reset.</incoming_comms_text>
  </event>
  <event name="Hack step succeeded" id_arme="cfa626be-a329-4fcf-bbbd-e18591ecf4a1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="1.0" />
    <log text="Hack step succeeded, now up to |HackStepsSucceeded|" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" integer="yes" />
    <incoming_comms_text from="Internal Comms" type="ALERT">Correct, we have now gotten through |HackStepsSucceeded| levels of the saboteur's^computer defenses!</incoming_comms_text>
  </event>
  <event name="BS1: Hack complete" id_arme="97d7d08e-7507-4173-bacf-f69a8c4683a4" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackStepsSucceeded" comparator="EQUALS" value="HackSuccessesNeeded" />
    <log text="Hack complete" />
    <warning_popup_message message="The Diana's engines have been disrupted" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" integer="yes" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <!--<incoming_comms_text from="Internal Comms" type="ALERT">Disruption complete, the Diana's engines are now disabled!  If we get within |ShipTransferRange|m of the Diana and send over a DamCon team to board her, we might be able to return her to TSN control.</incoming_comms_text>-->
    <incoming_comms_text from="Internal Comms" type="ALERT">Disruption complete, the Diana's engines are now disabled!  If we get within |ShipTransferRange|m of the Diana and send over a DamCon team to board her, we might be able to return her to TSN control.</incoming_comms_text>
    <set_variable name="BoardingState" value="1.0" />
    <set_timer name="RefreshCommsButtons" seconds="3" />
  </event>
  <event name="Saboteur disabled" id_arme="6e9e6abc-05db-4971-8ab0-3b29b5eba36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <if_variable name="HackStepsSucceeded" comparator="GREATER_EQUAL" value="HackSuccessesNeeded" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <set_object_property property="systemDamageBeam" value="100.0" name="Diana" />
  </event>
  <folder_arme name="Boarding" id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284" />
  <event name="Refresh damcon buttons" id_arme="fb1e0719-7ca8-4e53-b66f-de3e4630f30c" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="RefreshCommsButtons" />
    <log text="Refreshing buttons to send DamCon team to Diana" />
    <set_variable name="ArtemisDamCon1ButtonRefreshed" value="0.0" />
    <set_variable name="ArtemisDamCon2ButtonRefreshed" value="0.0" />
    <set_variable name="ArtemisDamCon3ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon1ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon2ButtonRefreshed" value="0.0" />
    <set_variable name="IntrepidDamCon3ButtonRefreshed" value="0.0" />
    <set_timer name="RefreshCommsButtons" seconds="3" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </event>
  <event name="Show Artemis DamCon 1 button" id_arme="fab1a80d-d1a4-44e3-ae63-b9901b4b9476" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Showed button for Artemis to send team DamCon team 1 to Diana" />
    <set_comms_button text="Send DamCon team 1" sideValue="3" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="2.0" />
  </event>
  <event name="Show Artemis DamCon 2 button" id_arme="85dcea4d-036d-41de-96fc-cd8760d5b993" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_comms_button text="Send DamCon team 2" sideValue="3" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="2.0" />
  </event>
  <event name="Show Artemis DamCon 3 button" id_arme="1c8b2fff-66da-4f8a-ae2b-aef8dc96ec69" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="3.0" />
    <if_damcon_members player_slot="0" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_comms_button text="Send DamCon team 3" sideValue="3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 1 button" id_arme="d83bb6c0-79a6-4707-8eb1-4671fab32e63" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Showed button for Intrepid to send team DamCon team 1 to Diana" />
    <set_comms_button text="Send DamCon team 1 " sideValue="4" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 2 button" id_arme="4e5f6e78-21f7-49d9-b20a-9e523effd27b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_comms_button text="Send DamCon team 2 " sideValue="4" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="2.0" />
  </event>
  <event name="Show Intrepid DamCon 3 button" id_arme="15bd250a-1ce5-498f-8f64-0854bea72266" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="EQUALS" value="1.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="4.0" />
    <if_damcon_members player_slot="1" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_comms_button text="Send DamCon team 3 " sideValue="4" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="2.0" />
  </event>
  <event name="Restore Artemis side" id_arme="16646f32-7c88-4545-9446-7bf9a1b80db9" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_exists name="Artemis" />
    <if_object_property property="sideValue" name="Artemis" comparator="NOT" value="2.0" />
    <log text="Restored Artemis to side 2" />
    <set_side_value value="2" name="Artemis" />
  </event>
  <event name="Restore Intrepid side" id_arme="3d5ed666-7872-4786-8307-6392563004aa" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_exists name="Intrepid" />
    <if_object_property property="sideValue" name="Intrepid" comparator="NOT" value="2.0" />
    <log text="Restored Intrepid to side 2" />
    <set_side_value value="2" name="Intrepid" />
  </event>
  <event name="Allow Artemis DamCon 1" id_arme="e09e7be1-c24c-4d3a-bee1-3e76a2e387e5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Allowing Artemis button to send DamCon team 1 to Diana" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon1ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Artemis DamCon 2" id_arme="22c31aa7-4be1-4e28-80f8-e3aee8ecd390" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon2ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Artemis DamCon 3" id_arme="aa7bdc06-be65-4208-9680-9aab5f98bda3" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Artemis" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="0" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Artemis" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_side_value value="3" name="Artemis" />
    <set_variable name="ArtemisDamCon3ButtonRefreshed" value="1.0" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 1" id_arme="d9eb046c-a441-41ef-ad9a-8724b03fb60c" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="0" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <log text="Allowing Intrepid button to send DamCon team 1 to Diana" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon1ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 2" id_arme="04aded95-cad1-4a50-8b20-a47aaee17863" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="1" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon2ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="1.0" />
  </event>
  <event name="Allow Intrepid DamCon 3" id_arme="8af32ac7-66fd-4716-a827-57eb9c75be64" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonRefreshed" comparator="EQUALS" value="0.0" />
    <if_object_property property="sideValue" name="Intrepid" comparator="EQUALS" value="2.0" />
    <if_damcon_members player_slot="1" team_index="2" comparator="EQUALS" value="6" />
    <if_distance name1="Diana" name2="Intrepid" comparator="LESS_EQUAL" value="ShipTransferRange" />
    <set_side_value value="4" name="Intrepid" />
    <set_variable name="IntrepidDamCon3ButtonRefreshed" value="1.0" />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="1.0" />
  </event>
  <event name="Disallow Artemis DamCon 1 for distance" id_arme="861df967-a1cb-4134-b39c-dc42209ec9fc" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="ShipTransferRange" />
    <log text="Disallowing Artemis button to send DamCon team 1 to Diana for distance" />
    <clear_comms_button text="Send DamCon team 1" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 2 for distance" id_arme="c7b1aab1-8345-4f08-a114-d154a8d3940d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="ShipTransferRange" />
    <clear_comms_button text="Send DamCon team 2" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Artemis DamCon 3 for distance" id_arme="ef8d13b6-356f-49fc-a142-bfad343b88e2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Artemis" comparator="GREATER" value="ShipTransferRange" />
    <clear_comms_button text="Send DamCon team 3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
  </event>
  <disabled_event name="Disallow Artemis DamCon 1 for size" id_arme="42434d6e-e1dd-4db1-af62-62e9c6c240c2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="0" team_index="0" comparator="LESS" value="6" />
    <log text="Disallowing Artemis button to send DamCon team 1 to Diana for size" />
    <clear_comms_button text="Send DamCon team 1" />
    <set_variable name="ArtemisDamCon1ButtonVisible" value="0.0" />
  </disabled_event>
  <disabled_event name="Disallow Artemis DamCon 2 for size" id_arme="7eca72a3-252e-418f-a1b2-d32472fea254" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="0" team_index="1" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 2" />
    <set_variable name="ArtemisDamCon2ButtonVisible" value="0.0" />
  </disabled_event>
  <disabled_event name="Disallow Artemis DamCon 3 for size" id_arme="f3ce1617-350d-4e02-aeb1-468d7bbce7c0" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="ArtemisDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="0" team_index="2" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 3" />
    <set_variable name="ArtemisDamCon3ButtonVisible" value="0.0" />
  </disabled_event>
  <event name="Disallow Intrepid DamCon 1 for distance" id_arme="d01155d6-4dda-4063-a811-7736f8ab996d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="ShipTransferRange" />
    <log text="Disallowing Intrepid button to send DamCon team 1 to Diana for distance" />
    <clear_comms_button text="Send DamCon team 1 " />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 2 for distance" id_arme="e251fa00-8368-4caf-85bc-ab38bd10e8c5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="ShipTransferRange" />
    <clear_comms_button text="Send DamCon team 2 " />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
  </event>
  <event name="Disallow Intrepid DamCon 3 for distance" id_arme="e0f69dc2-597e-43f4-af9b-f077b93b2cee" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <if_distance name1="Diana" name2="Intrepid" comparator="GREATER" value="ShipTransferRange" />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </event>
  <disabled_event name="Disallow Intrepid DamCon 1 for size" id_arme="2a69f573-dc68-4383-81f2-89561eb15492" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon1ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="1" team_index="0" comparator="LESS" value="6" />
    <log text="Disallowing Artemis button to send DamCon team 1 to Diana for size" />
    <clear_comms_button text="Send DamCon team 1 " />
    <set_variable name="IntrepidDamCon1ButtonVisible" value="0.0" />
  </disabled_event>
  <disabled_event name="Disallow Intrepid DamCon 2 for size" id_arme="49cb8b5f-974e-47db-bafd-20e5d7b47aa5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon2ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="1" team_index="1" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 2 " />
    <set_variable name="IntrepidDamCon2ButtonVisible" value="0.0" />
  </disabled_event>
  <disabled_event name="Disallow Intrepid DamCon 3 for size" id_arme="b5d27490-af7a-4838-8df1-a6f5022bdc75" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_variable name="IntrepidDamCon3ButtonVisible" comparator="GREATER" value="0.0" />
    <!--For v2.7.0, work around if_damcon_members bug by not requiring 6 people in team-->
    <if_damcon_members player_slot="1" team_index="2" comparator="LESS" value="6" />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_variable name="IntrepidDamCon3ButtonVisible" value="0.0" />
  </disabled_event>
  <event name="BS2: Assign Artemis DamCon 1" id_arme="31e5e72c-47d8-4e36-a15f-b155a9e79358" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 1" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="1.0" />
    <set_damcon_members value="0.0" team_index="0" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Artemis DamCon 2" id_arme="dd094294-9146-4872-93fb-b6a59b529821" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 2" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="2.0" />
    <set_damcon_members value="0.0" team_index="1" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Artemis DamCon 3" id_arme="e5fb7695-b388-4fd2-91bb-56b2b8baea61" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 3" />
    <set_variable name="DamConShipSent" value="1.0" />
    <set_variable name="DamConTeamSent" value="3.0" />
    <set_damcon_members value="0.0" team_index="2" player_slot="0" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 1" id_arme="679fd3f6-c5ea-4ea1-b13b-aae2ed367cb1" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 1 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="1.0" />
    <set_damcon_members value="0.0" team_index="0" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 2" id_arme="dd74731f-6928-4da8-913f-f0fb0ea09bc5" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 2 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="2.0" />
    <set_damcon_members value="0.0" team_index="1" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS2: Assign Intrepid DamCon 3" id_arme="5d8ff5fb-8a22-4f1d-bd36-078caa90a34f" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Send DamCon team 3 " />
    <set_variable name="DamConShipSent" value="2.0" />
    <set_variable name="DamConTeamSent" value="3.0" />
    <set_damcon_members value="0.0" team_index="2" player_slot="1" />
    <set_variable name="BoardingState" value="2.0" />
  </event>
  <event name="BS3: Artemis DamCon Transferred" id_arme="5ee8ee64-b366-470b-9f96-6a34cff84ec8" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="1.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="2.0" />
    <log text="Diana boarded by Artemis DamCon team |DamConTeamSent|" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_timer name="ReclaimDianaTimer" seconds="30" />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Artemis DamCon team |DamConTeamSent| reporting in.  We are now on board the TSN Diana.  The AI seems to be Arvonian!  We're working on regaining manual control...</incoming_comms_text>
    <set_variable name="BoardingState" value="3.0" />
    <!--If there were a way to remove the shuttlecraft from bay 0, we would do that here too, but there appears to be no way to do that.-->
  </event>
  <event name="BS3: Intrepid DamCon Transferred" id_arme="3449a8db-e774-40f0-be0a-92857e85e35b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="2.0" />
    <log text="Diana boarded by Intrepid DamCon team |DamConTeamSent|" />
    <clear_comms_button text="Send DamCon team 1" />
    <clear_comms_button text="Send DamCon team 2" />
    <clear_comms_button text="Send DamCon team 3" />
    <clear_comms_button text="Send DamCon team 1 " />
    <clear_comms_button text="Send DamCon team 2 " />
    <clear_comms_button text="Send DamCon team 3 " />
    <set_timer name="ReclaimDianaTimer" seconds="30" />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Intrepid DamCon team |DamConTeamSent| reporting in.  We are now on board the TSN Diana.  The AI seems to be Arvonian!  We're working on regaining manual control...</incoming_comms_text>
    <set_variable name="BoardingState" value="3.0" />
    <!--If there were a way to remove the shuttlecraft from bay 0, we would do that here too, but there appears to be no way to do that.-->
  </event>
  <event name="BS4: Artemis DamCon complete" id_arme="1e52fc4a-ff69-4b84-a57e-e2aa886f51d3" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="1.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="3.0" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="ReclaimDianaTimer" />
    <log text="Diana reclaimed by Artemis DamCon team |DamConTeamSent|" />
    <set_object_property property="sideValue" value="2.0" name="Diana" />
    <clear_ai name="Diana" />
    <add_ai type="POINT_THROTTLE" value1="StationX" value2="0.0" value3="StationZ" value4="1.0" name="Diana" />
    <set_ship_text name="Diana" scan_desc="Artemis DamCon team |DamConTeamSent| is on board taking her back to DS1." hailtext="We are taking the Diana back to DS1." />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Artemis DamCon team |DamConTeamSent| reporting in... From what we can tell, the AI must have been on the Diana for ages but only recently reawakened during repairs.  We have now regained control of the Diana and have set a course back to DS1!</incoming_comms_text>
    <incoming_comms_text from="DS1" type="STATION">Artemis, great work recapturing the Diana!  We'll take it from here, and interrogate the AI once the ship is safely back and locked down.</incoming_comms_text>
    <set_variable name="BoardingState" value="4.0" />
  </event>
  <event name="BS4: Intrepid DamCon complete" id_arme="7b453dce-f524-41cb-94f7-c9a5fb54d680" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="DamConShipSent" comparator="EQUALS" value="2.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="3.0" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="ReclaimDianaTimer" />
    <log text="Diana reclaimed by Intrepid DamCon team |DamConTeamSent|" />
    <set_object_property property="sideValue" value="2.0" name="Diana" />
    <clear_ai name="Diana" />
    <add_ai type="POINT_THROTTLE" value1="StationX" value2="0.0" value3="StationZ" value4="1.0" name="Diana" />
    <set_ship_text name="Diana" scan_desc="Intrepid DamCon team |DamConTeamSent| is on board taking her back to DS1." hailtext="We are taking the Diana back to DS1." />
    <incoming_comms_text from="TSN Diana" type="FRIEND">Intrepid DamCon team |DamConTeamSent| reporting in... From what we can tell, the AI must have been on the Diana for ages but only recently reawakened during repairs.  We have now regained control of the Diana and have set a course back to DS1!</incoming_comms_text>
    <incoming_comms_text from="DS1" type="STATION">Intrepid, great work recapturing the Diana!  We'll take it from here, and interrogate the AI once the ship is safely back and locked down.</incoming_comms_text>
    <set_variable name="BoardingState" value="4.0" />
  </event>
  <event name="DS1 Tractoring Diana +X" id_arme="665b8c6f-2ba0-4f01-8d40-9739ec0ad02d" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Diana" comparator="LESS" value="StationX" />
    <addto_object_property value="TractorStrength" property="positionX" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -X" id_arme="7643146c-0896-4c1b-877c-9b560afac029" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionX" name="Diana" comparator="GREATER" value="StationX" />
    <addto_object_property value="-TractorStrength" property="positionX" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana +Y" id_arme="826a785c-2f30-43fe-9433-9e746168d848" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Diana" comparator="LESS" value="StationY + 50" />
    <addto_object_property value="TractorStrength" property="positionY" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -Y" id_arme="be0fce18-a5c4-41bd-b440-7352569821b2" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionY" name="Diana" comparator="GREATER" value="StationY + 50" />
    <addto_object_property value="-TractorStrength" property="positionY" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana +Z" id_arme="696002d2-3797-46a5-969c-8691f20e8b17" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Diana" comparator="LESS" value="StationZ" />
    <addto_object_property value="TractorStrength" property="positionZ" name="Diana" />
  </event>
  <event name="DS1 Tractoring Diana -Z" id_arme="893633db-4fe5-45f6-b781-45e559492138" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="600.0" />
    <if_object_property property="positionZ" name="Diana" comparator="GREATER" value="StationZ" />
    <addto_object_property value="-TractorStrength" property="positionZ" name="Diana" />
  </event>
  <event name="BS5: Diana back at DS1" id_arme="e43560a1-938f-41fe-a723-b5fb16d70b54" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_distance name1="Diana" name2="DS1" comparator="LESS_EQUAL" value="150.0" />
    <if_variable name="BoardingState" comparator="EQUALS" value="4.0" />
    <log text="Diana back at DS1" />
    <set_variable name="BoardingState" value="5.0" />
    <incoming_comms_text from="DS1" type="STATION">We're interrogating the AI that took over the Diana.  It seems to be of Arvonian origin, and was apparently dormant in a damaged memory bank long before the Diana was towed here to DS1.  Recent repairs to the Diana must have reawakened it.  It seems possible that it was somehow connected to the Diana's original fate from which it was rescued during the recent Diana Operation.  More details will likely not be available until after you complete this mission, however.</incoming_comms_text>
  </event>
  <event name="Disable Diana impulse and turning" id_arme="994e81e4-ff2f-48c8-90e8-092bec8a176b" parent_id_arme="f1a464ed-43b1-44cf-9ec8-9bf40059f284">
    <if_exists name="Diana" />
    <if_variable name="BoardingState" comparator="EQUALS" value="5.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <clear_ai name="Diana" />
    <set_ship_text name="Diana" scan_desc="The Diana is unmanned, and is undergoing reconstruction." hailtext="We have nothing to say." />
    <!--The DamCon team is now just part of station repair personnel, so mark the Diana as unmanned again.-->
  </event>
</mission_data>