<mission_data version="2.6" background_id_arme="84327810-6e7d-41e7-9e71-391649f5b452" playerShipNames_arme="Artemis\Intrepid\Aegis\Horatio\Excalibur\Hera\Ceres\Diana">
  <start id_arme="84327810-6e7d-41e7-9e71-391649f5b452">
    <create count="200" type="asteroids" startX="90000.0" startY="0.0" startZ="38699.0" endX="10000.0" endY="0.0" endZ="28699.0" randomRange="20000" randomSeed="100" />
    <create count="200" type="asteroids" startX="90000.0" startY="200.0" startZ="38699.0" endX="10000.0" endY="200.0" endZ="28699.0" randomRange="20000" randomSeed="200" />
    <create count="200" type="asteroids" startX="90000.0" startY="-200.0" startZ="38699.0" endX="10000.0" endY="-200.0" endZ="28699.0" randomRange="20000" randomSeed="300" />
    <create count="200" type="asteroids" startX="90000.0" startY="-400.0" startZ="38699.0" endX="10000.0" endY="-400.0" endZ="28699.0" randomRange="20000" randomSeed="400" />
    <create count="200" type="asteroids" startX="90000.0" startY="400.0" startZ="38699.0" endX="10000.0" endY="400.0" endZ="28699.0" randomRange="20000" randomSeed="500" />
    <create type="player" x="48206.0" y="0.0" z="87373.0" angle="0" name="Artemis" />
    <create type="station" x="27764.0" y="0.0" z="73016.0" angle="0" name="DS1" raceKeys="friendly" hullKeys="Deep Space Base base" />
    <create type="neutral" x="27754.0" y="50.0" z="73016.0" angle="0" name="Diana" hullID="0" sideValue="2" />
    <create type="station" x="68960.0" y="0.0" z="20741.0" angle="0" name="AB1" raceKeys="enemy whalelover" hullKeys="base" sideValue="1" />
    <create type="enemy" x="60066.0" y="0.0" z="14499.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="1" />
    <create type="enemy" x="34630.0" y="0.0" z="33068.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="2" />
    <create type="enemy" x="78791.0" y="0.0" z="34473.0" angle="180" raceKeys="enemy whalelover" hullKeys="carrier" fleetnumber="3" />
    <set_skybox_index index="10" />
    <set_object_property property="nebulaIsOpaque" value="1" />
    <set_object_property property="musicObjectMasterVolume" value="0.0" />
    <set_variable name="DockedRange" value="100.0" />
    <!--TODO: change the delay below to 300-->
    <set_variable name="SabotageDelaySeconds" value="10.0" />
    <big_message title="A Spanner in the Works" subtitle1="A Diana Series Mission by Dave Thaler" subtitle2="adventure for Artemis 2.6" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
  </start>
  <folder_arme name="Initialization" id_arme="6ef97816-b707-4333-8e81-c10c250bf89b" expanded_arme="" />
  <event name="Set PlayerShipCount" id_arme="bc8332b6-2265-42dc-89c6-64fc9326d561" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_fleet_count comparator="GREATER" value="PlayerShipCount" />
    <set_variable name="PlayerShipCount" value="PlayerShipCount + 1" />
  </event>
  <event name="Diana created" id_arme="519bff8f-c77c-4692-b182-acda4ba82a5b" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
    <clear_ai name="Diana" />
    <!--Face north-->
    <set_object_property property="angle" value="3.14" name="Diana" />
    <set_ship_text name="Diana" scan_desc="The Diana is unmanned, and is undergoing reconstruction." />
  </event>
  <event name="Raise frequency A" id_arme="56e373d7-757d-4ee8-80f0-1a1fdfd92470" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength0" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency B" id_arme="a536a299-19b2-4f8a-a284-eea0f0e4b4be" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength1" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency C" id_arme="e8a54454-0838-4444-9361-9de10c992a38" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength2" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency D" id_arme="ddc2a914-96b9-4977-9510-10e1c80f72f8" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength3" value="TempRandom" name="Diana" />
  </event>
  <event name="Raise frequency E" id_arme="c2be3237-397a-47a4-914f-1bbde409b157" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="LESS" value="0.6" />
    <set_variable name="TempRandom" randomFloatLow="0.6" randomFloatHigh="0.85" />
    <set_object_property property="shieldBandStrength4" value="TempRandom" name="Diana" />
  </event>
  <event name="Lower frequency A" id_arme="50be9f21-8f6d-405f-8e8c-e98a3756517f" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_object_property property="shieldBandStrength0" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength0" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency B" id_arme="5749b266-8f7c-40a2-88a4-1f11d35295ef" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_object_property property="shieldBandStrength1" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength1" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency C" id_arme="e04c0fb3-2579-4955-9e63-7c0f9ba45140" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_object_property property="shieldBandStrength2" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength2" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency D" id_arme="c9bc2b97-e951-4d12-89cb-67e1cef2e04c" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_object_property property="shieldBandStrength3" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength3" value="0.5" name="Diana" />
  </event>
  <event name="Lower frequency E" id_arme="6cdf3470-cbbb-438e-8243-ad94c96f8cc1" parent_id_arme="6ef97816-b707-4333-8e81-c10c250bf89b">
    <if_exists name="Diana" />
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_object_property property="shieldBandStrength4" name="Diana" comparator="GREATER" value="0.5" />
    <set_object_property property="shieldBandStrength4" value="0.5" name="Diana" />
  </event>
  <folder_arme name="Start/End Game Events" id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1" />
  <event name="Start Title timer after first ship connects" id_arme="75a51448-2195-4afa-9ca8-864f45de62a0" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="51362_1_titleTimerStarted" comparator="EQUALS" value="0" />
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <set_timer name="51362_1_titleTimer" seconds="5" />
    <set_variable name="51362_1_titleTimerStarted" value="1" />
  </event>
  <event name="Show Title" id_arme="dca1c962-7f01-47cc-955a-8c0a98bf8cab" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="51362_1_delayedTitleShown" comparator="EQUALS" value="0" />
    <if_variable name="51362_1_gameShipsSpawned" comparator="GREATER" value="0" />
    <if_timer_finished name="51362_1_titleTimer" />
    <big_message title="The Diana Operation" subtitle1="written by Dave Thaler" subtitle2="" />
    <set_variable name="51362_1_delayedTitleShown" value="1" />
  </event>
  <event name="All Player Ships Destroyed" id_arme="42f2865c-0518-4e1b-bfc1-7556bdc0cd1b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="Aegis" />
    <if_not_exists name="Artemis" />
    <if_not_exists name="Intrepid" />
    <if_not_exists name="Horatio" />
    <if_not_exists name="Excalibur" />
    <if_not_exists name="Hera" />
    <if_not_exists name="Ceres" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <log text="FAILED because all player ships destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="All player ships have been destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^All player ships have been destroyed</incoming_comms_text>
  </event>
  <event name="End Game" id_arme="2f1aab6d-e5c1-489e-8dcd-e39c4660c27f" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="GameOver" comparator="EQUALS" value="1" />
    <if_timer_finished name="GameFinishedTimer" />
    <log text="End Game" />
    <end_mission />
  </event>
  <event name="All enemies destroyed" id_arme="8cd2c901-c296-44f2-9e21-34a669cf027b" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_not_exists name="AB1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <if_fleet_count comparator="EQUALS" value="0.0" />
    <log text="MISSION SUCCEEDED" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION SUCCEEDED" subtitle1="All enemies have been destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Succeeded^All enemy ships have been destroyed</incoming_comms_text>
  </event>
  <event name="Lost DS1" id_arme="b526982b-a60f-4850-8902-f0c9525953a5" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="DS1" />
    <if_variable name="GameOver" comparator="EQUALS" value="0" />
    <log text="FAILED because all player bases destroyed" />
    <big_message title="MISSION FAILED" subtitle1="All player bases have been destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^All player bases have been destroyed</incoming_comms_text>
    <set_variable name="GameOver" value="1" />
    <set_timer name="GameFinishedTimer" seconds="15" />
  </event>
  <event name="Lost Diana" id_arme="df728465-db6c-46d4-bf37-05eebdf4c22d" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_not_exists name="Diana" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the Diana was destroyed" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The TSN Diana was destroyed" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^The TSN Diana has been destroyed</incoming_comms_text>
  </event>
  <event name="Diana Escaped" id_arme="94bc79ae-5517-4033-afa4-2bfcf435e031" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0" />
    <if_inside_sphere name="Diana" centerX="68960.0" centerY="0.0" centerZ="0.0" radius="2500" />
    <if_variable name="GameOver" comparator="EQUALS" value="0.0" />
    <log text="FAILED because the saboteur escaped" />
    <set_variable name="GameOver" value="1.0" />
    <set_timer name="GameFinishedTimer" seconds="15" />
    <big_message title="MISSION FAILED" subtitle1="The saboteur escaped with the TSN Diana" subtitle2="" />
    <incoming_comms_text from="Main Screen" type="SIDE">Mission Failed^The saboteur escaped with the TSN Diana</incoming_comms_text>
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="b2cb0990-403d-4203-9f02-a732053e1d82" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="LESS" value="EnemiesLeft" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft - 1" />
  </event>
  <event name="DEBUG: EnemiesLeft" id_arme="28ef45b1-86b1-4256-9be3-f3c00eee8283" parent_id_arme="e829d865-90bd-4c1b-aabe-60c7d7cfe1a1">
    <if_fleet_count comparator="GREATER" value="EnemiesLeft" />
    <set_variable name="EnemiesLeft" value="EnemiesLeft + 1" />
  </event>
  <folder_arme name="Task: Dock with DS1 to receive orders" id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6" />
  <event name="Prepare to summon ships" id_arme="b5f53049-5cf3-43b7-b98d-6a92f25d26f1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="0.0" />
    <log text="Delaying before summoning ships" />
    <set_variable name="TsnCommandSummonedShips" value="1.0" />
    <set_timer name="RefreshGMButtons" seconds="1" />
    <set_timer name="StartupDelayBeforeOrders" seconds="10" />
  </event>
  <event name="TSN Command summons ships" id_arme="db11b82c-2c75-4dfb-b2e1-fef7eb5c91b4" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">All TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders.</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="2.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="600" />
    <set_timer name="StartupDelayBeforeOrders" seconds="120" />
  </event>
  <event name="TSN Command summons ships again" id_arme="7c3e3147-e599-4707-afd7-a957d9ce8684" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER" value="0.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_variable name="TsnCommandSummonedShips" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="StartupDelayBeforeOrders" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
  </event>
  <event name="GM summons ships again" id_arme="92f4ecc2-d839-4ba1-b5f4-8d35ddfeeac1" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <log text="TSN Command summoned ships again" />
    <warning_popup_message message="Message from TSN Command" consoles="M" />
    <incoming_comms_text from="TSN Command" type="SIDE ALERT">We repeat, all TSN ships in this sector are directed to dock at DS1 immediately to receive new mission orders!</incoming_comms_text>
    <set_variable name="TsnCommandSummonedShips" value="3.0" />
    <set_timer name="ShipsDueAtCommandBase" seconds="300" />
  </event>
  <event name="Task Succeeded - 1 Ship Docked" id_arme="179e7ae6-25f8-46c5-8916-6995e3c73883" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="1.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <incoming_comms_text from="DS1" type="SIDE">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict^with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed^to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship^reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an^assault on DS1.  Your mission is to protect 
both DS1 and the Diana from the Arvonian invasion.</incoming_comms_text>
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <set_variable name="TsnCommandGaveMission" value="1.0" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
  </event>
  <event name="Task Succeeded - 2 Ships Docked" id_arme="3c75cb0b-7be9-4c70-b4da-c32d8d05e60c" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="EQUALS" value="2.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <incoming_comms_text from="DS1" type="SIDE">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict^with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed^to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship^reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an^assault on DS1.  Your mission is to protect 
both DS1 and the Diana from the Arvonian invasion.</incoming_comms_text>
    <set_variable name="TsnCommandGaveMission" value="1.0" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
  </event>
  <event name="Task Succeeded - 3 Ships Docked" id_arme="bee1aff2-7bd6-4346-a020-863841bbeb14" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="PlayerShipCount" comparator="GREATER_EQUAL" value="3.0" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_distance name1="Aegis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange*1.6" />
    <if_docked name="DS1" />
    <log text="TSN Command issued mission orders" />
    <incoming_comms_text from="TSN Command" type="SIDE">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict^with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed^to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship^reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an^assault on DS1.  Your mission is to 
protect both DS1 and the Diana from the Arvonian invasion.</incoming_comms_text>
    <set_variable name="TsnCommandGaveMission" value="1.0" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
  </event>
  <event name="GM give mission" id_arme="c8c38a14-899f-4b30-9010-52298c0fde64" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_gm_button text="GM/Resend Comms/Give Mission" />
    <log text="GM gave mission" />
    <incoming_comms_text from="TSN Command" type="SIDE">As a result of the recent Diana Operation, the Torgoth have moved their fleets elsewhere in the conflict^with the TSN.  The Arvonians, however, have advanced and taken Houston Outpost, but not before we managed^to tow the crippled TSN Diana back here to DS1 where it is now undergoing reconstruction.  A scout ship^reported that an Arvonian base has just appeared in the asteroid belt, presumably in preparation for an^assault on DS1.  Your mission is to 
protect both DS1 and the Diana from the Arvonian invasion.</incoming_comms_text>
    <set_variable name="TsnCommandGaveMission" value="1.0" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
  </event>
  <event name="Mission Failed - Out of time" id_arme="875dc7e9-9018-49d1-8750-bd76aa7f387d" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0" />
    <if_timer_finished name="ShipsDueAtCommandBase" />
    <if_variable name="GameStatus" comparator="EQUALS" value="1.0" />
    <log text="Did not receive missions orders in time" />
    <incoming_comms_text from="TSN Command" type="SIDE">You did not follow orders from TSN Command in time!</incoming_comms_text>
    <set_variable name="GameStatus" value="0" />
  </event>
  <event name="Refresh GM buttons" id_arme="f1383e6f-ee03-4dce-872f-9f43586e0033" parent_id_arme="5dd7403b-8c13-4135-9ec9-b07cfae067f6">
    <if_exists name="DS1" />
    <if_timer_finished name="RefreshGMButtons" />
    <if_variable name="TsnCommandGaveMission" comparator="EQUALS" value="0.0" />
    <clear_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <clear_gm_button text="GM/Resend Comms/Give Mission" />
    <set_gm_button text="GM/Resend Comms/DS1 Resummon Ships" />
    <set_gm_button text="GM/Resend Comms/Give Mission" />
    <set_timer name="RefreshGMButtons" seconds="10" />
  </event>
  <folder_arme name="Sabotage" id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd" />
  <event name="Bomb Set" id_arme="9c900198-e63b-4408-9a57-32ae99e1e2ae" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="BombsDefused" />
    <if_timer_finished name="SabotageDelay" />
    <log text="Bomb set!" />
    <warning_popup_message message="Urgent message from DS1" consoles="M" />
    <incoming_comms_text from="DS1" type="STATION">URGENT: Immediate assistance needed at DS1!  We must have a sabotaur at work.  We just discovered a bomb on our station in the production facility!  Please dock with us as soon as possible and send a team of explosives experts who can deal with it before it detonates and destroys this station!  We have deactivated our final step in building more missiles so no more will be produced until the bomb is deactivated.</incoming_comms_text>
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="0" name="DS1" />
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
    <set_variable name="BombsSet" value="BombsSet + 1" integer="yes" />
    <set_variable name="WelcomedArtemisAwayTeam" value="0.0" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="0.0" />
    <set_variable name="WelcomedAegisAwayTeam" value="0.0" />
    <set_timer name="RefreshGMBombButtons" seconds="3" />
  </event>
  <event name="Artemis docked" id_arme="8aaa2492-326c-413c-a6ff-b38102c6a092" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Artemis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedArtemisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Artemis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedArtemisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Artemis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Intrepid docked" id_arme="4e9c9d7f-1cb0-49b7-bb0d-5b8aedd79088" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Intrepid" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedIntrepidAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Intrepid docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedIntrepidAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Intrepid. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Aegis docked" id_arme="4138f4e7-048b-429a-8666-a49be7fe3fbf" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_distance name1="Aegis" name2="DS1" comparator="LESS_EQUAL" value="DockedRange" />
    <if_variable name="WelcomedAegisAwayTeam" comparator="EQUALS" value="0.0" />
    <if_object_property property="canBuild" name="DS1" comparator="EQUALS" value="0.0" />
    <log text="Aegis docked at DS1 to defuse bomb" />
    <set_variable name="WelcomedAegisAwayTeam" value="1.0" />
    <incoming_comms_text from="DS1" type="STATION">Glad to see you, Aegis. An Away Team of explosives experts should immediately disembark and head over to the production facility on our station.</incoming_comms_text>
  </event>
  <event name="Refresh GM buttons" id_arme="b3049e32-14ce-4187-8b89-3322cce1a2f6" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_exists name="DS1" />
    <if_variable name="BombsSet" comparator="GREATER" value="BombsDefused" />
    <if_timer_finished name="RefreshGMButtons" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_gm_button text="Bomb defused" />
    <set_gm_button text="Bomb detonated" />
    <set_timer name="RefreshGMButtons" seconds="3" />
  </event>
  <event name="Bomb Defused" id_arme="552e39ad-0ac1-4fb8-abe1-490bed21d397" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb defused" />
    <log text="Bomb defused" />
    <clear_gm_button text="Bomb defused" />
    <clear_gm_button text="Bomb detonated" />
    <set_object_property property="canBuild" value="1" name="DS1" />
    <set_variable name="BombsDefused" value="BombsDefused + 1" />
    <incoming_comms_text from="DS1" type="STATION">Congratulations, the bomb has been defused and our production facility has resumed operation!</incoming_comms_text>
    <!---->
    <!--Schedule another sabotage attempt-->
    <!---->
    <set_timer name="SabotageDelay" seconds="SabotageDelaySeconds" />
  </event>
  <event name="Bomb Detonated" id_arme="486a7bdd-b0de-4d0e-ac93-723e5902f137" parent_id_arme="06783d9d-3423-44f3-b6e3-28e8f836b4fd">
    <if_gm_button text="Bomb detonated" />
    <log text="Bomb detonated!" />
    <clear_gm_button text="Bomb detonated" />
    <clear_gm_button text="Bomb defused" />
    <destroy name="DS1" />
    <warning_popup_message message="DS1 has been destroyed!" consoles="M" />
  </event>
  <folder_arme name="Escape" id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55" expanded_arme="" />
  <event name="Ready to escape" id_arme="3d4352b3-37f1-405a-b323-55357faac490" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_variable name="DianaReadyToEscape" comparator="EQUALS" value="0.0" />
    <if_variable name="BombsSet" comparator="EQUALS" value="2.0" />
    <log text="Saboteur about to escape" />
    <set_timer name="DianaEscapeTimer" seconds="30" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
  </event>
  <event name="Diana AI activates" id_arme="5ab5a2dd-561e-4ac8-b49a-0b96d416144e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_timer_finished name="DianaEscapeTimer" />
    <log text="Diana AI activates" />
    <!--Create a new ship that will become the Diana-->
    <!--We use a new ship instead of changing the side on the existing one, in order to reset the scanned level to 1.-->
    <create type="neutral" x="27754.0" y="50.0" z="73016.0" angle="0" name="Saboteur" hullID="0" sideValue="1" />
    <incoming_comms_text from="DS1" type="ALERT">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</incoming_comms_text>
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_timer name="RefreshHackButtons" seconds="30" />
  </event>
  <event name="Saboteur Diana created" id_arme="4348db9f-e7e7-4f47-a6bf-97663c7b37e7" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_exists name="Saboteur" />
    <log text="Saboteur Diana created" />
    <set_relative_position name2="Saboteur" distance="0" angle="0" name1="Diana" />
    <clear_ai name="Saboteur" />
    <set_object_property property="exitPointZ" value="0.0" name="Saboteur" />
    <set_object_property property="exitPointX" value="68960.0" name="Saboteur" />
    <destroy name="Diana" />
    <set_ship_text name="Saboteur" newname="Diana" scan_desc="Scans indicate no life signs aboard.  The saboteur must be an AI!" hailtext="I WILL NOT ACCEPT YOUR ORDERS.  END OF LINE." />
    <add_ai type="CHASE_ANGER" name="Diana" />
    <add_ai type="PROCEED_TO_EXIT" name="Diana" />
    <add_ai type="TRY_TO_BECOME_LEADER" name="Diana" />
  </event>
  <event name="DEBUG: Allow teleporting Diana" id_arme="8886e953-9017-4f5b-a389-50554e8d1d0d" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="TeleportDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="TeleportDianaButton" value="1.0" />
    <set_gm_button text="Teleport Diana" />
  </event>
  <event name="DEBUG: Teleport Diana" id_arme="118da934-bff8-448f-a242-8cef087a2007" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_gm_button text="Teleport Diana" />
    <log text="GM pressed Teleport Diana" />
    <set_object_property property="positionX" value="68940.0" name="Diana" />
    <set_object_property property="positionY" value="0.0" name="Diana" />
    <set_object_property property="positionZ" value="500.0" name="Diana" />
  </event>
  <event name="DEBUG: Allow activating saboteur" id_arme="8989b6b2-c483-4886-86e8-aa5f7e993d60" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_variable name="ActivateDianaButton" comparator="EQUALS" value="0.0" />
    <set_variable name="ActivateDianaButton" value="1.0" />
    <set_gm_button text="Activate saboteur" />
  </event>
  <event name="DEBUG: Activate saboteur" id_arme="b35f06a9-3a65-4d3c-85de-9155572d4d5e" parent_id_arme="354d7eaa-5c2c-486e-81cb-5d977f7d5f55">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="2.0" />
    <if_gm_button text="Activate saboteur" />
    <log text="GM pressed Activate saboteur" />
    <set_variable name="DianaReadyToEscape" value="1.0" />
    <clear_gm_button text="Activate saboteur" />
    <set_timer name="DianaEscapeTimer" seconds="1" />
  </event>
  <folder_arme name="Hacking" id_arme="a587676a-7998-4d34-80cd-cee990ddefc1" expanded_arme="" />
  <event name="Ready to hack" id_arme="4d8b42f5-75fa-4443-8643-59c610e9868c" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <!--One-time event to start hacking capability-->
    <if_variable name="ReadyToHack" comparator="EQUALS" value="0.0" />
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_timer_finished name="RefreshHackButtons" />
    <log text="Ready to hack" />
    <set_variable name="ReadyToHack" value="1.0" />
    <set_timer name="RefreshHackButtons" seconds="10" />
    <incoming_comms_text from="Internal Comms" type="SIDE">We can try to disrupt the Diana's computer system to stop the saboteur, but we'll have to get through multiple layers of defenses.  We'll need to use its lowest shield frequency to do so.</incoming_comms_text>
  </event>
  <event name="Refresh hack buttons" id_arme="342cc4d2-3696-4a8f-b0dc-7159300c4cfe" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="ReadyToHack" comparator="EQUALS" value="1.0" />
    <if_exists name="Diana" />
    <if_timer_finished name="RefreshHackButtons" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_variable name="HackStepsSucceeded" comparator="LESS" value="3.0" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <set_comms_button text="Hack frequency A" />
    <set_comms_button text="Hack frequency B" />
    <set_comms_button text="Hack frequency C" />
    <set_comms_button text="Hack frequency D" />
    <set_comms_button text="Hack frequency E" />
    <set_timer name="RefreshHackButtons" seconds="10" />
    <!--TODO: delete the following line-->
    <incoming_comms_text from="DEBUG" type="ALERT">refreshing hack buttons</incoming_comms_text>
  </event>
  <event name="Hack A success" id_arme="00e10622-08be-4b6e-aed9-6bc590e765ca" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack B  success" id_arme="0f9188f4-c88c-4deb-90f3-0cdf254dccf1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack C success" id_arme="fc7bb871-93e5-4eb6-aea2-16d4ed2412e6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack D success" id_arme="743278cd-bf39-4a69-8114-0939b0ef4550" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack E success" id_arme="e26e1c0d-117c-401e-8326-359c8d81b36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="EQUALS" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <set_variable name="HackResult" value="1.0" />
  </event>
  <event name="Hack A fail" id_arme="42e749e3-8e4d-46d1-b52a-76ce65c15f02" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="0.0" />
    <if_comms_button text="Hack frequency A" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack B fail" id_arme="689261c5-02d4-4eaa-9147-c585e1d9d659" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="1.0" />
    <if_comms_button text="Hack frequency B" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack C fail" id_arme="0c590657-25e7-4c88-a0ed-22c734dcc005" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="2.0" />
    <if_comms_button text="Hack frequency C" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack D fail" id_arme="83a5ed74-685a-4943-a79c-c3b273da0d58" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="3.0" />
    <if_comms_button text="Hack frequency D" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack E fail" id_arme="b43d584e-f7c4-4ce2-876e-87b76ae6aab6" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="BestFrequency" comparator="NOT" value="4.0" />
    <if_comms_button text="Hack frequency E" />
    <set_variable name="HackResult" value="2.0" />
  </event>
  <event name="Hack step failed" id_arme="21c46882-1a4b-4ba4-9006-875cf570a590" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="2.0" />
    <log text="Hack step failed" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="0.0" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Inorrect, all computer defenses have been reset.</incoming_comms_text>
  </event>
  <event name="Hack step succeeded" id_arme="cfa626be-a329-4fcf-bbbd-e18591ecf4a1" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackResult" comparator="EQUALS" value="1.0" />
    <log text="Hack step succeeded, now up to ^HackStepsSucceeded^" />
    <set_variable name="BestFrequency" randomIntLow="0" randomIntHigh="4" />
    <warning_popup_message message="The Diana's energy signature has changed" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackResult" value="0.0" />
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Correct, we have now gotten through ^HackStepsSucceeded^ levels of the saboteur's computer defenses!</incoming_comms_text>
  </event>
  <event name="Hack complete" id_arme="97d7d08e-7507-4173-bacf-f69a8c4683a4" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_variable name="HackStepsSucceeded" comparator="EQUALS" value="3.0" />
    <log text="Hack complete" />
    <warning_popup_message message="The Diana's engines have been disrupted" consoles="S">Unauthorized undocking of the Diana detected!  The saboteur must be trying to escape!</warning_popup_message>
    <set_variable name="HackStepsSucceeded" value="HackStepsSucceeded + 1" />
    <clear_comms_button text="Hack frequency A" />
    <clear_comms_button text="Hack frequency B" />
    <clear_comms_button text="Hack frequency C" />
    <clear_comms_button text="Hack frequency D" />
    <clear_comms_button text="Hack frequency E" />
    <incoming_comms_text from="Internal Comms" type="SIDE">Disruption complete, the Diana's engines are now disabled!  We can send over a DamCon team to board her and return her to TSN control.</incoming_comms_text>
  </event>
  <event name="Saboteur disabled" id_arme="6e9e6abc-05db-4971-8ab0-3b29b5eba36d" parent_id_arme="a587676a-7998-4d34-80cd-cee990ddefc1">
    <if_exists name="Diana" />
    <if_object_property property="sideValue" name="Diana" comparator="EQUALS" value="1.0" />
    <if_object_property property="systemDamageImpulse" name="Diana" comparator="LESS" value="100.0" />
    <if_variable name="HackStepsSucceeded" comparator="GREATER_EQUAL" value="3.0" />
    <set_object_property property="systemDamageTurning" value="100.0" name="Diana" />
    <set_object_property property="systemDamageImpulse" value="100.0" name="Diana" />
  </event>
</mission_data>